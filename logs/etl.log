2026-01-17 18:45:40,423 | INFO | Inicio del pipeline ETL
2026-01-17 18:45:40,424 | INFO | Clientes encontrados: 1
2026-01-17 18:45:40,424 | INFO | Tarjetas encontradas: 1
2026-01-17 18:45:40,424 | INFO | Ficheros ignorados: 1
2026-01-17 18:45:40,424 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-17 18:45:40,426 | INFO | Filas leídas CLIENTES: 30
2026-01-17 18:45:40,429 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-17 18:45:40,431 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-17 18:45:40,431 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-17 18:45:40,432 | INFO | Filas leídas TARJETAS: 29
2026-01-17 18:45:40,433 | INFO | Filas rechazadas TARJETAS: 0
2026-01-17 18:45:40,434 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-17 18:45:40,435 | WARNING | Total filas erróneas registradas: 30
2026-01-17 18:45:40,435 | INFO | Fin del pipeline ETL
2026-01-17 19:00:31,917 | INFO | Inicio del pipeline ETL
2026-01-17 19:00:31,917 | INFO | Clientes encontrados: 1
2026-01-17 19:00:31,917 | INFO | Tarjetas encontradas: 1
2026-01-17 19:00:31,917 | INFO | Ficheros ignorados: 1
2026-01-17 19:00:31,917 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-17 19:00:31,919 | INFO | Filas leídas CLIENTES: 30
2026-01-17 19:00:31,925 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-17 19:00:31,925 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-17 19:00:31,925 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-17 19:00:31,927 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-17 19:00:31,927 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-17 19:00:31,928 | INFO | Filas leídas TARJETAS: 29
2026-01-17 19:00:31,930 | INFO | Filas rechazadas TARJETAS: 0
2026-01-17 19:00:31,930 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-17 19:00:31,932 | WARNING | Total filas erróneas registradas: 30
2026-01-17 19:00:31,932 | INFO | Fin del pipeline ETL
2026-01-17 19:06:12,457 | INFO | Inicio del pipeline ETL
2026-01-17 19:06:12,458 | INFO | Clientes encontrados: 1
2026-01-17 19:06:12,458 | INFO | Tarjetas encontradas: 1
2026-01-17 19:06:12,458 | INFO | Ficheros ignorados: 1
2026-01-17 19:06:12,458 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-17 19:06:12,460 | INFO | Filas leídas CLIENTES: 30
2026-01-17 19:06:12,463 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-17 19:06:12,464 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-17 19:06:12,464 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-17 19:06:12,466 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-17 19:06:12,466 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-17 19:06:12,466 | INFO | Filas leídas TARJETAS: 29
2026-01-17 19:06:12,468 | INFO | Filas rechazadas TARJETAS: 0
2026-01-17 19:06:12,468 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-17 19:06:12,470 | WARNING | Total filas erróneas registradas: 30
2026-01-17 19:06:12,470 | INFO | Fin del pipeline ETL
2026-01-17 19:12:33,440 | INFO | Inicio del pipeline ETL
2026-01-17 19:12:33,441 | INFO | Clientes encontrados: 1
2026-01-17 19:12:33,441 | INFO | Tarjetas encontradas: 1
2026-01-17 19:12:33,441 | INFO | Ficheros ignorados: 1
2026-01-17 19:12:33,441 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-17 19:12:33,443 | INFO | Filas leídas CLIENTES: 30
2026-01-17 19:12:33,446 | ERROR | Error procesando CLIENTES: Clientes-2025-11-10.csv
Traceback (most recent call last):
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7096, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'error_detalle'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 70, in main
    df, errs = validate_clientes(df)
               ~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\validate_clientes.py", line 57, in validate_clientes
    invalid["error"] = invalid["error_detalle"]
                       ~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\frame.py", line 4113, in __getitem__
    indexer = self.columns.get_loc(key)
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\pandas\core\indexes\base.py", line 3819, in get_loc
    raise KeyError(key) from err
KeyError: 'error_detalle'
2026-01-17 19:12:33,467 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-17 19:12:33,468 | INFO | Filas leídas TARJETAS: 29
2026-01-17 19:12:33,469 | INFO | Filas rechazadas TARJETAS: 0
2026-01-17 19:12:33,471 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-17 19:12:33,471 | INFO | No hay filas erróneas. No se generan CSV de rechazadas
2026-01-17 19:12:33,471 | INFO | Fin del pipeline ETL
2026-01-17 19:12:52,716 | INFO | Inicio del pipeline ETL
2026-01-17 19:12:52,716 | INFO | Clientes encontrados: 1
2026-01-17 19:12:52,716 | INFO | Tarjetas encontradas: 1
2026-01-17 19:12:52,716 | INFO | Ficheros ignorados: 1
2026-01-17 19:12:52,716 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-17 19:12:52,718 | INFO | Filas leídas CLIENTES: 30
2026-01-17 19:12:52,723 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-17 19:12:52,723 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-17 19:12:52,723 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-17 19:12:52,725 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-17 19:12:52,725 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-17 19:12:52,726 | INFO | Filas leídas TARJETAS: 29
2026-01-17 19:12:52,728 | INFO | Filas rechazadas TARJETAS: 0
2026-01-17 19:12:52,728 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-17 19:12:52,730 | WARNING | Total filas erróneas registradas: 30
2026-01-17 19:12:52,730 | INFO | Fin del pipeline ETL
2026-01-17 19:13:27,216 | INFO | Inicio del pipeline ETL
2026-01-17 19:13:27,216 | INFO | Clientes encontrados: 1
2026-01-17 19:13:27,216 | INFO | Tarjetas encontradas: 1
2026-01-17 19:13:27,216 | INFO | Ficheros ignorados: 1
2026-01-17 19:13:27,216 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-17 19:13:27,218 | INFO | Filas leídas CLIENTES: 30
2026-01-17 19:13:27,224 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-17 19:13:27,224 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-17 19:13:27,224 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-17 19:13:27,226 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-17 19:13:27,227 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-17 19:13:27,227 | INFO | Filas leídas TARJETAS: 29
2026-01-17 19:13:27,229 | INFO | Filas rechazadas TARJETAS: 0
2026-01-17 19:13:27,230 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-17 19:13:27,231 | WARNING | Total filas erróneas registradas: 30
2026-01-17 19:13:27,231 | INFO | Fin del pipeline ETL
2026-01-17 19:18:00,569 | INFO | Inicio del pipeline ETL
2026-01-17 19:18:00,570 | INFO | Clientes encontrados: 1
2026-01-17 19:18:00,570 | INFO | Tarjetas encontradas: 1
2026-01-17 19:18:00,570 | INFO | Ficheros ignorados: 1
2026-01-17 19:18:00,570 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-17 19:18:00,572 | INFO | Filas leídas CLIENTES: 30
2026-01-17 19:18:00,576 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-17 19:18:00,576 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-17 19:18:00,576 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-17 19:18:00,578 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-17 19:18:00,578 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-17 19:18:00,579 | INFO | Filas leídas TARJETAS: 29
2026-01-17 19:18:00,580 | INFO | Filas rechazadas TARJETAS: 0
2026-01-17 19:18:00,581 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-17 19:18:00,582 | WARNING | Total filas erróneas registradas: 30
2026-01-17 19:18:00,583 | INFO | Fin del pipeline ETL
2026-01-18 23:22:20,394 | INFO | Inicio del pipeline ETL
2026-01-18 23:22:20,395 | INFO | Clientes encontrados: 1
2026-01-18 23:22:20,395 | INFO | Tarjetas encontradas: 1
2026-01-18 23:22:20,395 | INFO | Ficheros ignorados: 1
2026-01-18 23:22:20,395 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:22:20,401 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:22:20,406 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:22:20,407 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:22:20,407 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:22:20,412 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:22:20,412 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:22:20,413 | INFO | Filas leídas TARJETAS: 29
2026-01-18 23:22:20,415 | INFO | Filas rechazadas TARJETAS: 0
2026-01-18 23:22:20,416 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:22:20,417 | WARNING | Total filas erróneas registradas: 30
2026-01-18 23:22:20,417 | INFO | Fin del pipeline ETL
2026-01-18 23:23:05,559 | INFO | Inicio del pipeline ETL
2026-01-18 23:23:05,560 | INFO | Clientes encontrados: 1
2026-01-18 23:23:05,560 | INFO | Tarjetas encontradas: 1
2026-01-18 23:23:05,560 | INFO | Ficheros ignorados: 1
2026-01-18 23:23:05,560 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:23:05,562 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:23:05,567 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:23:05,567 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:23:05,567 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:23:05,569 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:23:05,569 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:23:05,570 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:23:05,571 | INFO | Filas rechazadas TARJETAS: 0
2026-01-18 23:23:05,572 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:23:05,574 | WARNING | Total filas erróneas registradas: 30
2026-01-18 23:23:05,574 | INFO | Fin del pipeline ETL
2026-01-18 23:23:11,728 | INFO | Inicio del pipeline ETL
2026-01-18 23:23:11,728 | INFO | Clientes encontrados: 1
2026-01-18 23:23:11,728 | INFO | Tarjetas encontradas: 1
2026-01-18 23:23:11,728 | INFO | Ficheros ignorados: 1
2026-01-18 23:23:11,728 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:23:11,730 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:23:11,735 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:23:11,735 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:23:11,735 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:23:11,738 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:23:11,738 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:23:11,738 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:23:11,740 | INFO | Filas rechazadas TARJETAS: 0
2026-01-18 23:23:11,741 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:23:11,742 | WARNING | Total filas erróneas registradas: 30
2026-01-18 23:23:11,742 | INFO | Fin del pipeline ETL
2026-01-18 23:23:50,855 | INFO | Inicio del pipeline ETL
2026-01-18 23:23:50,856 | INFO | Clientes encontrados: 1
2026-01-18 23:23:50,856 | INFO | Tarjetas encontradas: 1
2026-01-18 23:23:50,856 | INFO | Ficheros ignorados: 1
2026-01-18 23:23:50,856 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:23:50,858 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:23:50,863 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:23:50,864 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:23:50,864 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:23:50,866 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:23:50,866 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:23:50,867 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:23:50,869 | INFO | Filas rechazadas TARJETAS: 0
2026-01-18 23:23:50,870 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:23:50,871 | WARNING | Total filas erróneas registradas: 30
2026-01-18 23:23:50,871 | INFO | Fin del pipeline ETL
2026-01-18 23:24:53,642 | INFO | Inicio del pipeline ETL
2026-01-18 23:24:53,642 | INFO | Clientes encontrados: 1
2026-01-18 23:24:53,642 | INFO | Tarjetas encontradas: 1
2026-01-18 23:24:53,642 | INFO | Ficheros ignorados: 1
2026-01-18 23:24:53,642 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:24:53,644 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:24:53,649 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:24:53,649 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:24:53,649 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:24:53,651 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:24:53,651 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:24:53,653 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:24:53,654 | INFO | Filas rechazadas TARJETAS: 0
2026-01-18 23:24:53,655 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:24:53,657 | WARNING | Total filas erróneas registradas: 30
2026-01-18 23:24:53,657 | INFO | Fin del pipeline ETL
2026-01-18 23:25:34,575 | INFO | Inicio del pipeline ETL
2026-01-18 23:25:34,575 | INFO | Clientes encontrados: 1
2026-01-18 23:25:34,576 | INFO | Tarjetas encontradas: 1
2026-01-18 23:25:34,576 | INFO | Ficheros ignorados: 1
2026-01-18 23:25:34,576 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:25:34,577 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:25:34,582 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:25:34,583 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:25:34,583 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:25:34,585 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:25:34,585 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:25:34,586 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:25:34,588 | INFO | Filas rechazadas TARJETAS: 0
2026-01-18 23:25:34,588 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:25:34,590 | WARNING | Total filas erróneas registradas: 30
2026-01-18 23:25:34,590 | INFO | Fin del pipeline ETL
2026-01-18 23:26:09,284 | INFO | Inicio del pipeline ETL
2026-01-18 23:26:09,285 | INFO | Clientes encontrados: 1
2026-01-18 23:26:09,285 | INFO | Tarjetas encontradas: 1
2026-01-18 23:26:09,285 | INFO | Ficheros ignorados: 1
2026-01-18 23:26:09,285 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:26:09,287 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:26:09,292 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:26:09,292 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:26:09,292 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:26:09,294 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:26:09,294 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:26:09,295 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:26:09,297 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-18 23:26:09,297 | WARNING | TARJETAS (sin columna error_detalle)
2026-01-18 23:26:09,298 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:26:09,300 | WARNING | Total filas erróneas registradas: 31
2026-01-18 23:26:09,300 | INFO | Fin del pipeline ETL
2026-01-18 23:26:53,082 | INFO | Inicio del pipeline ETL
2026-01-18 23:26:53,082 | INFO | Clientes encontrados: 1
2026-01-18 23:26:53,082 | INFO | Tarjetas encontradas: 1
2026-01-18 23:26:53,082 | INFO | Ficheros ignorados: 1
2026-01-18 23:26:53,082 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:26:53,084 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:26:53,089 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:26:53,089 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:26:53,089 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:26:53,091 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:26:53,091 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:26:53,092 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:26:53,095 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-18 23:26:53,095 | WARNING | TARJETAS (sin columna error_detalle)
2026-01-18 23:26:53,096 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:26:53,099 | WARNING | Total filas erróneas registradas: 31
2026-01-18 23:26:53,099 | INFO | Fin del pipeline ETL
2026-01-18 23:41:20,729 | INFO | Inicio del pipeline ETL
2026-01-18 23:41:20,731 | INFO | Clientes encontrados: 1
2026-01-18 23:41:20,731 | INFO | Tarjetas encontradas: 1
2026-01-18 23:41:20,731 | INFO | Ficheros ignorados: 1
2026-01-18 23:41:20,731 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:41:20,734 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:41:20,739 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:41:20,739 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:41:20,739 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:41:20,742 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:41:20,742 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:41:20,743 | INFO | Filas leídas TARJETAS: 29
2026-01-18 23:41:20,746 | ERROR | Error procesando TARJETAS: Tarjetas-2025-11-10.csv
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 91, in main
    df, errs = validate_tarjetas(df) # <- SOLO valida (OK/KO + rechazadas)
    ^^^^^^^^
ValueError: too many values to unpack (expected 2, got 3)
2026-01-18 23:41:20,749 | WARNING | Total filas erróneas registradas: 30
2026-01-18 23:41:20,749 | INFO | Fin del pipeline ETL
2026-01-18 23:46:01,559 | INFO | Inicio del pipeline ETL
2026-01-18 23:46:01,560 | INFO | Clientes encontrados: 1
2026-01-18 23:46:01,560 | INFO | Tarjetas encontradas: 1
2026-01-18 23:46:01,560 | INFO | Ficheros ignorados: 1
2026-01-18 23:46:01,560 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:46:01,562 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:46:01,566 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:46:01,567 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:46:01,567 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:46:01,569 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:46:01,569 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:46:01,570 | INFO | Filas leídas TARJETAS: 29
2026-01-18 23:46:01,573 | INFO | Filas rechazadas TARJETAS: 0
2026-01-18 23:46:01,574 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:46:01,575 | WARNING | Total filas erróneas registradas: 30
2026-01-18 23:46:01,575 | INFO | Fin del pipeline ETL
2026-01-18 23:47:48,106 | INFO | Inicio del pipeline ETL
2026-01-18 23:47:48,107 | INFO | Clientes encontrados: 1
2026-01-18 23:47:48,107 | INFO | Tarjetas encontradas: 1
2026-01-18 23:47:48,107 | INFO | Ficheros ignorados: 1
2026-01-18 23:47:48,107 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:47:48,109 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:47:48,115 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:47:48,115 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:47:48,115 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:47:48,117 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:47:48,117 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:47:48,118 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:47:48,122 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-18 23:47:48,123 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-18 23:47:48,124 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:47:48,127 | WARNING | Total filas erróneas registradas: 31
2026-01-18 23:47:48,127 | INFO | Fin del pipeline ETL
2026-01-18 23:52:12,950 | INFO | Inicio del pipeline ETL
2026-01-18 23:52:12,950 | INFO | Clientes encontrados: 1
2026-01-18 23:52:12,950 | INFO | Tarjetas encontradas: 1
2026-01-18 23:52:12,950 | INFO | Ficheros ignorados: 1
2026-01-18 23:52:12,950 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:52:12,953 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:52:12,958 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:52:12,959 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:52:12,959 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:52:12,961 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:52:12,961 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:52:12,962 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:52:12,966 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-18 23:52:12,966 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-18 23:52:12,967 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:52:12,970 | WARNING | Total filas erróneas registradas: 31
2026-01-18 23:52:12,970 | INFO | Fin del pipeline ETL
2026-01-18 23:53:02,571 | INFO | Inicio del pipeline ETL
2026-01-18 23:53:02,572 | INFO | Clientes encontrados: 1
2026-01-18 23:53:02,572 | INFO | Tarjetas encontradas: 1
2026-01-18 23:53:02,572 | INFO | Ficheros ignorados: 1
2026-01-18 23:53:02,572 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:53:02,575 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:53:02,581 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:53:02,582 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:53:02,582 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:53:02,584 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:53:02,584 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:53:02,585 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:53:02,589 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-18 23:53:02,589 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-18 23:53:02,590 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:53:02,593 | WARNING | Total filas erróneas registradas: 31
2026-01-18 23:53:02,593 | INFO | Fin del pipeline ETL
2026-01-18 23:54:19,945 | INFO | Inicio del pipeline ETL
2026-01-18 23:54:19,946 | INFO | Clientes encontrados: 1
2026-01-18 23:54:19,946 | INFO | Tarjetas encontradas: 1
2026-01-18 23:54:19,946 | INFO | Ficheros ignorados: 1
2026-01-18 23:54:19,946 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-18 23:54:19,948 | INFO | Filas leídas CLIENTES: 30
2026-01-18 23:54:19,953 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-18 23:54:19,954 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-18 23:54:19,954 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-18 23:54:19,955 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-18 23:54:19,955 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-18 23:54:19,956 | INFO | Filas leídas TARJETAS: 30
2026-01-18 23:54:19,960 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-18 23:54:19,960 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-18 23:54:19,961 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-18 23:54:19,964 | WARNING | Total filas erróneas registradas: 31
2026-01-18 23:54:19,964 | INFO | Fin del pipeline ETL
2026-01-19 00:01:37,098 | INFO | Inicio del pipeline ETL
2026-01-19 00:01:37,099 | INFO | Clientes encontrados: 1
2026-01-19 00:01:37,099 | INFO | Tarjetas encontradas: 1
2026-01-19 00:01:37,099 | INFO | Ficheros ignorados: 1
2026-01-19 00:01:37,099 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 00:01:37,101 | INFO | Filas leídas CLIENTES: 30
2026-01-19 00:01:37,106 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 00:01:37,106 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 00:01:37,106 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 00:01:37,108 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 00:01:37,108 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 00:01:37,109 | INFO | Filas leídas TARJETAS: 30
2026-01-19 00:01:37,113 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 00:01:37,114 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 00:01:37,115 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 00:01:37,117 | WARNING | Total filas erróneas registradas: 31
2026-01-19 00:01:37,117 | INFO | Fin del pipeline ETL
2026-01-19 00:06:24,171 | INFO | Inicio del pipeline ETL
2026-01-19 00:06:24,172 | INFO | Clientes encontrados: 1
2026-01-19 00:06:24,172 | INFO | Tarjetas encontradas: 1
2026-01-19 00:06:24,172 | INFO | Ficheros ignorados: 1
2026-01-19 00:06:24,172 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 00:06:24,175 | INFO | Filas leídas CLIENTES: 30
2026-01-19 00:06:24,179 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 00:06:24,179 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 00:06:24,179 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 00:06:24,181 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 00:06:24,181 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 00:06:24,182 | INFO | Filas leídas TARJETAS: 30
2026-01-19 00:06:24,185 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 00:06:24,186 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 00:06:24,187 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 00:06:24,192 | WARNING | Total filas erróneas registradas: 31
2026-01-19 00:06:24,192 | INFO | Fin del pipeline ETL
2026-01-19 00:13:14,970 | INFO | Inicio del pipeline ETL
2026-01-19 00:13:14,970 | INFO | Clientes encontrados: 1
2026-01-19 00:13:14,970 | INFO | Tarjetas encontradas: 1
2026-01-19 00:13:14,970 | INFO | Ficheros ignorados: 1
2026-01-19 00:13:14,970 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 00:13:14,973 | INFO | Filas leídas CLIENTES: 30
2026-01-19 00:13:14,979 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 00:13:14,980 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 00:13:14,980 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 00:13:14,982 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 00:13:14,982 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 00:13:14,983 | INFO | Filas leídas TARJETAS: 30
2026-01-19 00:13:14,987 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 00:13:14,988 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 00:13:14,989 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 00:13:14,995 | WARNING | Total filas erróneas registradas: 31
2026-01-19 00:13:14,995 | INFO | Fin del pipeline ETL
2026-01-19 00:18:11,029 | INFO | Inicio del pipeline ETL
2026-01-19 00:18:11,030 | INFO | Clientes encontrados: 1
2026-01-19 00:18:11,030 | INFO | Tarjetas encontradas: 1
2026-01-19 00:18:11,030 | INFO | Ficheros ignorados: 1
2026-01-19 00:18:11,030 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 00:18:11,032 | INFO | Filas leídas CLIENTES: 30
2026-01-19 00:18:11,036 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 00:18:11,037 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 00:18:11,037 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 00:18:11,039 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 00:18:11,039 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 00:18:11,039 | INFO | Filas leídas TARJETAS: 30
2026-01-19 00:18:11,044 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 00:18:11,044 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 00:18:11,045 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 00:18:11,052 | WARNING | Total filas erróneas registradas: 31
2026-01-19 00:18:11,052 | INFO | Fin del pipeline ETL
2026-01-19 00:20:05,897 | INFO | Inicio del pipeline ETL
2026-01-19 00:20:05,898 | INFO | Clientes encontrados: 1
2026-01-19 00:20:05,898 | INFO | Tarjetas encontradas: 1
2026-01-19 00:20:05,898 | INFO | Ficheros ignorados: 1
2026-01-19 00:20:05,898 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 00:20:05,901 | INFO | Filas leídas CLIENTES: 30
2026-01-19 00:20:05,907 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 00:20:05,908 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 00:20:05,908 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 00:20:05,910 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 00:20:05,910 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 00:20:05,911 | INFO | Filas leídas TARJETAS: 30
2026-01-19 00:20:05,916 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 00:20:05,917 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 00:20:05,918 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 00:20:05,925 | WARNING | Total filas erróneas registradas: 31
2026-01-19 00:20:05,925 | INFO | Fin del pipeline ETL
2026-01-19 00:37:05,942 | INFO | Inicio del pipeline ETL
2026-01-19 00:37:05,942 | INFO | Clientes encontrados: 1
2026-01-19 00:37:05,942 | INFO | Tarjetas encontradas: 1
2026-01-19 00:37:05,942 | INFO | Ficheros ignorados: 1
2026-01-19 00:37:05,942 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 00:37:05,945 | INFO | Filas leídas CLIENTES: 30
2026-01-19 00:37:05,951 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 00:37:05,951 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 00:37:05,952 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 00:37:05,953 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 00:37:05,953 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 00:37:05,954 | INFO | Filas leídas TARJETAS: 30
2026-01-19 00:37:05,957 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 00:37:05,958 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 00:37:05,959 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 00:37:05,965 | WARNING | Total filas erróneas registradas: 31
2026-01-19 00:37:05,965 | INFO | Fin del pipeline ETL
2026-01-19 00:41:20,900 | INFO | Inicio del pipeline ETL
2026-01-19 00:41:20,901 | INFO | Clientes encontrados: 1
2026-01-19 00:41:20,901 | INFO | Tarjetas encontradas: 1
2026-01-19 00:41:20,901 | INFO | Ficheros ignorados: 1
2026-01-19 00:41:20,901 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 00:41:20,904 | INFO | Filas leídas CLIENTES: 30
2026-01-19 00:41:20,910 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 00:41:20,911 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 00:41:20,911 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 00:41:20,912 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 00:41:20,912 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 00:41:20,913 | INFO | Filas leídas TARJETAS: 30
2026-01-19 00:41:20,917 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 00:41:20,917 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 00:41:20,918 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 00:41:20,925 | WARNING | Total filas erróneas registradas: 31
2026-01-19 00:41:20,925 | INFO | Fin del pipeline ETL
2026-01-19 00:48:42,385 | INFO | Inicio del pipeline ETL
2026-01-19 00:48:42,385 | INFO | Clientes encontrados: 1
2026-01-19 00:48:42,385 | INFO | Tarjetas encontradas: 1
2026-01-19 00:48:42,386 | INFO | Ficheros ignorados: 1
2026-01-19 00:48:42,386 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 00:48:42,388 | INFO | Filas leídas CLIENTES: 30
2026-01-19 00:48:42,393 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 00:48:42,393 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 00:48:42,393 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 00:48:42,395 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 00:48:42,395 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 00:48:42,396 | INFO | Filas leídas TARJETAS: 30
2026-01-19 00:48:42,399 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 00:48:42,400 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 00:48:42,401 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 00:48:42,407 | WARNING | Total filas erróneas registradas: 31
2026-01-19 00:48:42,407 | INFO | Fin del pipeline ETL
2026-01-19 00:55:43,302 | INFO | Inicio del pipeline ETL
2026-01-19 00:55:43,303 | INFO | Clientes encontrados: 1
2026-01-19 00:55:43,303 | INFO | Tarjetas encontradas: 1
2026-01-19 00:55:43,303 | INFO | Ficheros ignorados: 1
2026-01-19 00:55:43,303 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 00:55:43,306 | INFO | Filas leídas CLIENTES: 30
2026-01-19 00:55:43,312 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 00:55:43,313 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 00:55:43,313 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 00:55:43,314 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 00:55:43,314 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 00:55:43,315 | INFO | Filas leídas TARJETAS: 30
2026-01-19 00:55:43,319 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 00:55:43,319 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 00:55:43,320 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 00:55:43,327 | WARNING | Total filas erróneas registradas: 31
2026-01-19 00:55:43,327 | INFO | Fin del pipeline ETL
2026-01-19 01:02:09,175 | INFO | Inicio del pipeline ETL
2026-01-19 01:02:09,176 | INFO | Clientes encontrados: 1
2026-01-19 01:02:09,176 | INFO | Tarjetas encontradas: 1
2026-01-19 01:02:09,176 | INFO | Ficheros ignorados: 1
2026-01-19 01:02:09,176 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 01:02:09,179 | INFO | Filas leídas CLIENTES: 30
2026-01-19 01:02:09,184 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 01:02:09,185 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 01:02:09,185 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 01:02:09,186 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 01:02:09,186 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 01:02:09,187 | INFO | Filas leídas TARJETAS: 30
2026-01-19 01:02:09,190 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 01:02:09,191 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 01:02:09,192 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 01:02:09,198 | WARNING | Total filas erróneas registradas: 31
2026-01-19 01:02:09,198 | INFO | Fin del pipeline ETL
2026-01-19 01:03:03,542 | INFO | Inicio del pipeline ETL
2026-01-19 01:03:03,543 | INFO | Clientes encontrados: 1
2026-01-19 01:03:03,543 | INFO | Tarjetas encontradas: 1
2026-01-19 01:03:03,543 | INFO | Ficheros ignorados: 1
2026-01-19 01:03:03,543 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 01:03:03,546 | INFO | Filas leídas CLIENTES: 30
2026-01-19 01:03:03,551 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 01:03:03,551 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 01:03:03,551 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 01:03:03,552 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 01:03:03,552 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 01:03:03,553 | INFO | Filas leídas TARJETAS: 30
2026-01-19 01:03:03,557 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 01:03:03,557 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 01:03:03,558 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 01:03:03,563 | WARNING | Total filas erróneas registradas: 31
2026-01-19 01:03:03,563 | INFO | Fin del pipeline ETL
2026-01-19 01:06:01,758 | INFO | Inicio del pipeline ETL
2026-01-19 01:06:01,759 | INFO | Clientes encontrados: 1
2026-01-19 01:06:01,759 | INFO | Tarjetas encontradas: 1
2026-01-19 01:06:01,759 | INFO | Ficheros ignorados: 1
2026-01-19 01:06:01,759 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 01:06:01,762 | INFO | Filas leídas CLIENTES: 30
2026-01-19 01:06:01,767 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 01:06:01,768 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 01:06:01,768 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 01:06:01,769 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 01:06:01,769 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 01:06:01,770 | INFO | Filas leídas TARJETAS: 30
2026-01-19 01:06:01,774 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 01:06:01,774 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 01:06:01,775 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 01:06:01,781 | WARNING | Total filas erróneas registradas: 31
2026-01-19 01:06:01,781 | INFO | Fin del pipeline ETL
2026-01-19 11:04:19,092 | INFO | Inicio del pipeline ETL
2026-01-19 11:04:19,093 | INFO | Clientes encontrados: 1
2026-01-19 11:04:19,093 | INFO | Tarjetas encontradas: 1
2026-01-19 11:04:19,093 | INFO | Ficheros ignorados: 1
2026-01-19 11:04:19,093 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 11:04:19,099 | INFO | Filas leídas CLIENTES: 31
2026-01-19 11:04:19,106 | WARNING | Filas rechazadas CLIENTES: 31
2026-01-19 11:04:19,107 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 11:04:19,108 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 6
2026-01-19 11:04:19,113 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 11:04:19,114 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 11:04:19,115 | INFO | Filas leídas TARJETAS: 30
2026-01-19 11:04:19,119 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 11:04:19,119 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 11:04:19,120 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 11:04:19,129 | WARNING | Total filas erróneas registradas: 32
2026-01-19 11:04:19,129 | INFO | Fin del pipeline ETL
2026-01-19 11:24:13,683 | INFO | Inicio del pipeline ETL
2026-01-19 11:24:13,684 | INFO | Clientes encontrados: 1
2026-01-19 11:24:13,684 | INFO | Tarjetas encontradas: 1
2026-01-19 11:24:13,684 | INFO | Ficheros ignorados: 1
2026-01-19 11:24:13,684 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 11:24:13,688 | INFO | Filas leídas CLIENTES: 36
2026-01-19 11:24:13,693 | WARNING | Filas rechazadas CLIENTES: 32
2026-01-19 11:24:13,694 | WARNING | CLIENTES motivo='dni_invalido' -> 26
2026-01-19 11:24:13,694 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 6
2026-01-19 11:24:13,696 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 11:24:13,696 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 11:24:13,697 | INFO | Filas leídas TARJETAS: 30
2026-01-19 11:24:13,701 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 11:24:13,701 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 11:24:13,702 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 11:24:13,709 | WARNING | Total filas erróneas registradas: 33
2026-01-19 11:24:13,709 | INFO | Fin del pipeline ETL
2026-01-19 11:25:30,809 | INFO | Inicio del pipeline ETL
2026-01-19 11:25:30,810 | INFO | Clientes encontrados: 1
2026-01-19 11:25:30,810 | INFO | Tarjetas encontradas: 1
2026-01-19 11:25:30,810 | INFO | Ficheros ignorados: 1
2026-01-19 11:25:30,810 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 11:25:30,813 | INFO | Filas leídas CLIENTES: 36
2026-01-19 11:25:30,818 | WARNING | Filas rechazadas CLIENTES: 32
2026-01-19 11:25:30,819 | WARNING | CLIENTES motivo='dni_invalido' -> 26
2026-01-19 11:25:30,819 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 6
2026-01-19 11:25:30,820 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 11:25:30,821 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 11:25:30,822 | INFO | Filas leídas TARJETAS: 30
2026-01-19 11:25:30,826 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 11:25:30,826 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 11:25:30,827 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 11:25:30,834 | WARNING | Total filas erróneas registradas: 33
2026-01-19 11:25:30,834 | INFO | Fin del pipeline ETL
2026-01-19 12:02:03,804 | INFO | Inicio del pipeline ETL
2026-01-19 12:02:03,805 | INFO | Clientes encontrados: 1
2026-01-19 12:02:03,805 | INFO | Tarjetas encontradas: 1
2026-01-19 12:02:03,805 | INFO | Ficheros ignorados: 1
2026-01-19 12:02:03,805 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 12:02:03,808 | INFO | Filas leídas CLIENTES: 30
2026-01-19 12:02:03,813 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 12:02:03,814 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 12:02:03,814 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 12:02:03,815 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 12:02:03,815 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 12:02:03,816 | INFO | Filas leídas TARJETAS: 30
2026-01-19 12:02:03,820 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 12:02:03,820 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 12:02:03,821 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 12:02:03,828 | WARNING | Total filas erróneas registradas: 31
2026-01-19 12:02:03,828 | INFO | Fin del pipeline ETL
2026-01-19 19:45:12,769 | INFO | Inicio del pipeline ETL
2026-01-19 19:45:12,770 | INFO | Clientes encontrados: 1
2026-01-19 19:45:12,770 | INFO | Tarjetas encontradas: 1
2026-01-19 19:45:12,770 | INFO | Ficheros ignorados: 1
2026-01-19 19:45:12,770 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 19:45:12,776 | INFO | Filas leídas CLIENTES: 35
2026-01-19 19:45:12,786 | WARNING | Filas rechazadas CLIENTES: 31
2026-01-19 19:45:12,788 | WARNING | CLIENTES motivo='dni_invalido' -> 26
2026-01-19 19:45:12,788 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 19:45:12,791 | INFO | Archivo generado: C:\Users\jorge.de3\Documents\GitHub\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 19:45:12,791 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 19:45:12,806 | INFO | Filas leídas TARJETAS: 30
2026-01-19 19:45:12,811 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 19:45:12,812 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 19:45:12,814 | INFO | Archivo generado: C:\Users\jorge.de3\Documents\GitHub\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 19:45:12,822 | WARNING | Total filas erróneas registradas: 32
2026-01-19 19:45:12,822 | INFO | Fin del pipeline ETL
2026-01-19 20:03:28,498 | INFO | Inicio del pipeline ETL
2026-01-19 20:03:28,499 | INFO | Clientes encontrados: 1
2026-01-19 20:03:28,499 | INFO | Tarjetas encontradas: 1
2026-01-19 20:03:28,499 | INFO | Ficheros ignorados: 1
2026-01-19 20:03:28,499 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-19 20:03:28,520 | INFO | Filas leídas CLIENTES: 30
2026-01-19 20:03:28,525 | WARNING | Filas rechazadas CLIENTES: 30
2026-01-19 20:03:28,526 | WARNING | CLIENTES motivo='dni_invalido' -> 25
2026-01-19 20:03:28,526 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-19 20:03:28,528 | INFO | Archivo generado: C:\Users\jorge.de3\Documents\GitHub\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-19 20:03:28,528 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-19 20:03:28,538 | INFO | Filas leídas TARJETAS: 30
2026-01-19 20:03:28,543 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-19 20:03:28,543 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-19 20:03:28,544 | INFO | Archivo generado: C:\Users\jorge.de3\Documents\GitHub\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-19 20:03:28,562 | WARNING | Total filas erróneas registradas: 31
2026-01-19 20:03:28,562 | INFO | Fin del pipeline ETL
2026-01-20 00:46:45,696 | INFO | Inicio del pipeline ETL
2026-01-20 00:46:45,697 | INFO | Clientes encontrados: 1
2026-01-20 00:46:45,697 | INFO | Tarjetas encontradas: 1
2026-01-20 00:46:45,697 | INFO | Ficheros ignorados: 1
2026-01-20 00:46:45,697 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 00:46:45,702 | INFO | Filas leídas CLIENTES: 30
2026-01-20 00:46:45,708 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 00:46:45,709 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 00:46:45,713 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-20 00:46:45,713 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 00:46:45,714 | INFO | Filas leídas TARJETAS: 30
2026-01-20 00:46:45,718 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 00:46:45,718 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 00:46:45,719 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-20 00:46:45,724 | WARNING | Total filas erróneas registradas: 6
2026-01-20 00:46:45,724 | INFO | Fin del pipeline ETL
2026-01-20 01:05:20,947 | INFO | Inicio del pipeline ETL
2026-01-20 01:05:20,948 | INFO | Clientes encontrados: 1
2026-01-20 01:05:20,948 | INFO | Tarjetas encontradas: 1
2026-01-20 01:05:20,948 | INFO | Ficheros ignorados: 1
2026-01-20 01:05:20,948 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 01:05:20,950 | INFO | Filas leídas CLIENTES: 30
2026-01-20 01:05:20,955 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 01:05:20,956 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 01:05:20,957 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Clientes-2025-11-10.cleaned.csv
2026-01-20 01:05:20,957 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 01:05:20,958 | INFO | Filas leídas TARJETAS: 30
2026-01-20 01:05:20,961 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 01:05:20,961 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 01:05:20,962 | INFO | Archivo generado: C:\Users\jorge\IdeaProjects\etl-proyecto\data\output\Tarjetas-2025-11-10.cleaned.csv
2026-01-20 01:05:20,967 | WARNING | Total filas erróneas registradas: 6
2026-01-20 01:05:20,967 | INFO | Fin del pipeline ETL
2026-01-20 01:15:14,208 | INFO | Inicio del pipeline ETL
2026-01-20 01:15:14,209 | INFO | Clientes encontrados: 1
2026-01-20 01:15:14,209 | INFO | Tarjetas encontradas: 1
2026-01-20 01:15:14,209 | INFO | Ficheros ignorados: 1
2026-01-20 01:15:14,209 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 01:15:14,212 | INFO | Filas leídas CLIENTES: 30
2026-01-20 01:15:14,217 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 01:15:14,218 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 01:15:14,219 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 01:15:14,219 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 01:15:14,220 | INFO | Filas leídas TARJETAS: 30
2026-01-20 01:15:14,223 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 01:15:14,224 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 01:15:14,224 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 01:15:14,230 | WARNING | Total filas erróneas registradas: 6
2026-01-20 01:15:14,230 | INFO | Fin del pipeline ETL
2026-01-20 01:24:38,049 | INFO | Inicio del pipeline ETL
2026-01-20 01:24:38,049 | INFO | Clientes encontrados: 1
2026-01-20 01:24:38,049 | INFO | Tarjetas encontradas: 1
2026-01-20 01:24:38,049 | INFO | Ficheros ignorados: 1
2026-01-20 01:24:38,049 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 01:24:38,052 | INFO | Filas leídas CLIENTES: 30
2026-01-20 01:24:38,058 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 01:24:38,058 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 01:24:38,059 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 01:24:38,059 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 01:24:38,060 | INFO | Filas leídas TARJETAS: 30
2026-01-20 01:24:38,064 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 01:24:38,064 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 01:24:38,065 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 01:24:38,070 | WARNING | Total filas erróneas registradas: 6
2026-01-20 01:24:38,070 | INFO | Fin del pipeline ETL
2026-01-20 01:24:59,663 | INFO | Inicio del pipeline ETL
2026-01-20 01:24:59,664 | INFO | Clientes encontrados: 1
2026-01-20 01:24:59,664 | INFO | Tarjetas encontradas: 1
2026-01-20 01:24:59,664 | INFO | Ficheros ignorados: 1
2026-01-20 01:24:59,664 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 01:24:59,667 | INFO | Filas leídas CLIENTES: 30
2026-01-20 01:24:59,672 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 01:24:59,672 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 01:24:59,673 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 01:24:59,673 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 01:24:59,675 | INFO | Filas leídas TARJETAS: 30
2026-01-20 01:24:59,677 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 01:24:59,678 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 01:24:59,678 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 01:24:59,684 | WARNING | Total filas erróneas registradas: 6
2026-01-20 01:24:59,684 | INFO | Fin del pipeline ETL
2026-01-20 01:34:37,071 | INFO | Inicio del pipeline ETL
2026-01-20 01:34:37,072 | INFO | Clientes encontrados: 1
2026-01-20 01:34:37,072 | INFO | Tarjetas encontradas: 1
2026-01-20 01:34:37,072 | INFO | Ficheros ignorados: 1
2026-01-20 01:34:37,072 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 01:34:37,075 | INFO | Filas leídas CLIENTES: 30
2026-01-20 01:34:37,080 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 01:34:37,081 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 01:34:37,082 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 01:34:37,082 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 01:34:37,083 | INFO | Filas leídas TARJETAS: 30
2026-01-20 01:34:37,086 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 01:34:37,087 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 01:34:37,088 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 01:34:37,093 | WARNING | Total filas erróneas registradas: 6
2026-01-20 01:34:37,093 | INFO | Fin del pipeline ETL
2026-01-20 19:47:07,836 | INFO | Inicio del pipeline ETL
2026-01-20 19:47:07,838 | INFO | Clientes encontrados: 1
2026-01-20 19:47:07,838 | INFO | Tarjetas encontradas: 1
2026-01-20 19:47:07,839 | INFO | Ficheros ignorados: 1
2026-01-20 19:47:07,839 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 19:47:07,847 | INFO | Filas leídas CLIENTES: 30
2026-01-20 19:47:07,865 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 19:47:07,867 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 19:47:07,870 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 19:47:07,870 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 19:47:07,873 | INFO | Filas leídas TARJETAS: 30
2026-01-20 19:47:07,883 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 19:47:07,884 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 19:47:07,886 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 19:47:07,905 | WARNING | Total filas erróneas registradas: 6
2026-01-20 19:47:07,905 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-20 19:47:07,906 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-20 19:47:07,967 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "c:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\scripts\run_pipeline.py", line 159, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 156, in load_cleaned_to_postgres
    conn = _get_conn()
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 28, in _get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=os.getenv("PGHOST", "localhost"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        password=os.getenv("PGPASSWORD"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\anvir\AppData\Local\Programs\Python\Python313\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
2026-01-20 19:47:07,970 | INFO | Fin del pipeline ETL
2026-01-20 19:52:01,928 | INFO | Inicio del pipeline ETL
2026-01-20 19:52:01,929 | INFO | Clientes encontrados: 1
2026-01-20 19:52:01,929 | INFO | Tarjetas encontradas: 1
2026-01-20 19:52:01,930 | INFO | Ficheros ignorados: 1
2026-01-20 19:52:01,930 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 19:52:01,936 | INFO | Filas leídas CLIENTES: 30
2026-01-20 19:52:01,947 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 19:52:01,948 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 19:52:01,952 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 19:52:01,952 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 19:52:01,955 | INFO | Filas leídas TARJETAS: 30
2026-01-20 19:52:01,964 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 19:52:01,965 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 19:52:01,967 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 19:52:01,981 | WARNING | Total filas erróneas registradas: 6
2026-01-20 19:52:01,981 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-20 19:52:01,982 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-20 19:52:02,036 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "c:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\scripts\run_pipeline.py", line 159, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 156, in load_cleaned_to_postgres
    conn = _get_conn()
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 28, in _get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=os.getenv("PGHOST", "localhost"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        password=os.getenv("PGPASSWORD"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\anvir\AppData\Local\Programs\Python\Python313\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 96: invalid start byte
2026-01-20 19:52:02,039 | INFO | Fin del pipeline ETL
2026-01-20 19:53:41,997 | INFO | Inicio del pipeline ETL
2026-01-20 19:53:41,998 | INFO | Clientes encontrados: 1
2026-01-20 19:53:41,998 | INFO | Tarjetas encontradas: 1
2026-01-20 19:53:41,999 | INFO | Ficheros ignorados: 1
2026-01-20 19:53:41,999 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 19:53:42,004 | INFO | Filas leídas CLIENTES: 30
2026-01-20 19:53:42,016 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 19:53:42,018 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 19:53:42,021 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 19:53:42,022 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 19:53:42,024 | INFO | Filas leídas TARJETAS: 30
2026-01-20 19:53:42,032 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 19:53:42,033 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 19:53:42,036 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 19:53:42,049 | WARNING | Total filas erróneas registradas: 6
2026-01-20 19:53:42,050 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-20 19:53:42,051 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-20 19:53:42,112 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "c:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\scripts\run_pipeline.py", line 159, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 158, in load_cleaned_to_postgres
    conn = _get_conn()
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 30, in _get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=os.getenv("PGHOST", "localhost"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        password=os.getenv("PGPASSWORD"),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\anvir\AppData\Local\Programs\Python\Python313\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 96: invalid start byte
2026-01-20 19:53:42,115 | INFO | Fin del pipeline ETL
2026-01-20 20:00:01,762 | INFO | Inicio del pipeline ETL
2026-01-20 20:00:01,763 | INFO | Clientes encontrados: 1
2026-01-20 20:00:01,764 | INFO | Tarjetas encontradas: 1
2026-01-20 20:00:01,764 | INFO | Ficheros ignorados: 1
2026-01-20 20:00:01,764 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 20:00:01,770 | INFO | Filas leídas CLIENTES: 30
2026-01-20 20:00:01,787 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 20:00:01,788 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 20:00:01,792 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 20:00:01,792 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 20:00:01,796 | INFO | Filas leídas TARJETAS: 30
2026-01-20 20:00:01,809 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 20:00:01,810 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 20:00:01,813 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 20:00:01,833 | WARNING | Total filas erróneas registradas: 6
2026-01-20 20:00:01,834 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-20 20:00:01,836 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-20 20:00:01,993 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "c:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\scripts\run_pipeline.py", line 159, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 174, in load_cleaned_to_postgres
    conn = _get_conn()
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 43, in _get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=host,
        ^^^^^^^^^^
    ...<6 lines>...
        connect_timeout=5,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\anvir\AppData\Local\Programs\Python\Python313\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 96: invalid start byte
2026-01-20 20:00:01,996 | INFO | Fin del pipeline ETL
2026-01-20 20:08:04,819 | INFO | Inicio del pipeline ETL
2026-01-20 20:08:04,821 | INFO | Clientes encontrados: 1
2026-01-20 20:08:04,821 | INFO | Tarjetas encontradas: 1
2026-01-20 20:08:04,822 | INFO | Ficheros ignorados: 1
2026-01-20 20:08:04,822 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 20:08:04,828 | INFO | Filas leídas CLIENTES: 30
2026-01-20 20:08:04,840 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 20:08:04,842 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 20:08:04,845 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 20:08:04,845 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 20:08:04,849 | INFO | Filas leídas TARJETAS: 30
2026-01-20 20:08:04,858 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 20:08:04,859 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 20:08:04,861 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 20:08:04,875 | WARNING | Total filas erróneas registradas: 6
2026-01-20 20:08:04,875 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-20 20:08:04,876 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-20 20:08:04,965 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\scripts\run_pipeline.py", line 159, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 163, in load_cleaned_to_postgres
    _load_clientes_csv(conn, f, logger=logger)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 114, in _load_clientes_csv
    execute_values(cur, sql, rows, page_size=1000)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\AppData\Local\Programs\Python\Python313\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.SyntaxError: INSERT tiene más expresiones que columnas de destino
LINE 6: ...xample.com',612345678,'Y',true,'N',false,'Y',true,'N',false,...
                                                             ^

2026-01-20 20:08:04,968 | INFO | Fin del pipeline ETL
2026-01-20 20:10:49,853 | INFO | Inicio del pipeline ETL
2026-01-20 20:10:49,855 | INFO | Clientes encontrados: 1
2026-01-20 20:10:49,855 | INFO | Tarjetas encontradas: 1
2026-01-20 20:10:49,855 | INFO | Ficheros ignorados: 1
2026-01-20 20:10:49,856 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 20:10:49,862 | INFO | Filas leídas CLIENTES: 30
2026-01-20 20:10:49,875 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 20:10:49,876 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 20:10:49,880 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 20:10:49,880 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 20:10:49,883 | INFO | Filas leídas TARJETAS: 30
2026-01-20 20:10:49,892 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 20:10:49,893 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 20:10:49,895 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 20:10:49,909 | WARNING | Total filas erróneas registradas: 6
2026-01-20 20:10:49,909 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-20 20:10:49,911 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-20 20:10:49,986 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-20 20:10:49,995 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-20 20:10:49,996 | INFO | Carga a PostgreSQL completada
2026-01-20 20:10:49,996 | INFO | Fin del pipeline ETL
2026-01-20 20:18:14,945 | INFO | Inicio del pipeline ETL
2026-01-20 20:18:14,946 | INFO | Clientes encontrados: 1
2026-01-20 20:18:14,947 | INFO | Tarjetas encontradas: 1
2026-01-20 20:18:14,947 | INFO | Ficheros ignorados: 1
2026-01-20 20:18:14,947 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 20:18:14,966 | INFO | Filas leídas CLIENTES: 33
2026-01-20 20:18:14,979 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 20:18:14,980 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 20:18:14,984 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 20:18:14,984 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 20:18:14,988 | INFO | Filas leídas TARJETAS: 32
2026-01-20 20:18:14,998 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 20:18:14,999 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 20:18:15,002 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 20:18:15,015 | WARNING | Total filas erróneas registradas: 6
2026-01-20 20:18:15,016 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-20 20:18:15,017 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-20 20:18:15,109 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 28 filas
2026-01-20 20:18:15,132 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "c:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\scripts\run_pipeline.py", line 159, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 178, in load_cleaned_to_postgres
    _load_tarjetas_csv(conn, f, logger=logger)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\OneDrive\Escritorio\2ºDAM\ETL\etl-proyecto\etl\db_loader.py", line 153, in _load_tarjetas_csv
    execute_values(cur, sql, rows, page_size=1000)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anvir\AppData\Local\Programs\Python\Python313\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.ForeignKeyViolation: inserción o actualización en la tabla «tarjetas» viola la llave foránea «fk_tarjetas_clientes»
DETAIL:  La llave (cod_cliente)=(C099) no está presente en la tabla «clientes».

2026-01-20 20:18:15,135 | INFO | Fin del pipeline ETL
2026-01-20 20:19:05,413 | INFO | Inicio del pipeline ETL
2026-01-20 20:19:05,414 | INFO | Clientes encontrados: 1
2026-01-20 20:19:05,414 | INFO | Tarjetas encontradas: 1
2026-01-20 20:19:05,415 | INFO | Ficheros ignorados: 1
2026-01-20 20:19:05,415 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-20 20:19:05,438 | INFO | Filas leídas CLIENTES: 30
2026-01-20 20:19:05,450 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-20 20:19:05,451 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-20 20:19:05,455 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-20 20:19:05,455 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-20 20:19:05,469 | INFO | Filas leídas TARJETAS: 30
2026-01-20 20:19:05,478 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-20 20:19:05,479 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-20 20:19:05,482 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-20 20:19:05,496 | WARNING | Total filas erróneas registradas: 6
2026-01-20 20:19:05,496 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-20 20:19:05,497 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-20 20:19:05,566 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-20 20:19:05,572 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-20 20:19:05,573 | INFO | Carga a PostgreSQL completada
2026-01-20 20:19:05,573 | INFO | Fin del pipeline ETL
2026-01-21 15:26:43,584 | INFO | Inicio del pipeline ETL
2026-01-21 15:26:43,586 | INFO | Clientes encontrados: 1
2026-01-21 15:26:43,586 | INFO | Tarjetas encontradas: 1
2026-01-21 15:26:43,586 | INFO | Ficheros ignorados: 1
2026-01-21 15:26:43,586 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-21 15:26:43,605 | INFO | Filas leídas CLIENTES: 30
2026-01-21 15:26:43,622 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-21 15:26:43,623 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-21 15:26:43,629 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-21 15:26:43,629 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-21 15:26:43,650 | INFO | Filas leídas TARJETAS: 30
2026-01-21 15:26:43,658 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-21 15:26:43,660 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-21 15:26:43,662 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-21 15:26:43,678 | WARNING | Total filas erróneas registradas: 6
2026-01-21 15:26:43,680 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-21 15:26:43,681 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-21 15:26:43,930 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-21 15:26:43,953 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-21 15:26:43,953 | INFO | Carga a PostgreSQL completada
2026-01-21 15:26:43,953 | INFO | Fin del pipeline ETL
2026-01-21 15:35:23,815 | INFO | Inicio del pipeline ETL
2026-01-21 15:35:23,817 | INFO | Clientes encontrados: 1
2026-01-21 15:35:23,817 | INFO | Tarjetas encontradas: 1
2026-01-21 15:35:23,817 | INFO | Ficheros ignorados: 1
2026-01-21 15:35:23,818 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-21 15:35:23,823 | INFO | Filas leídas CLIENTES: 30
2026-01-21 15:35:23,835 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-21 15:35:23,836 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-21 15:35:23,840 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-21 15:35:23,840 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-21 15:35:23,844 | INFO | Filas leídas TARJETAS: 30
2026-01-21 15:35:23,852 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-21 15:35:23,853 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-21 15:35:23,855 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-21 15:35:23,869 | WARNING | Total filas erróneas registradas: 6
2026-01-21 15:35:23,869 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-21 15:35:23,870 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-21 15:35:23,942 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-21 15:35:23,954 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-21 15:35:23,955 | INFO | Carga a PostgreSQL completada
2026-01-21 15:35:23,955 | INFO | Fin del pipeline ETL
2026-01-22 18:29:57,414 | INFO | Inicio del pipeline ETL
2026-01-22 18:29:57,415 | INFO | Clientes encontrados: 1
2026-01-22 18:29:57,416 | INFO | Tarjetas encontradas: 1
2026-01-22 18:29:57,416 | INFO | Ficheros ignorados: 1
2026-01-22 18:29:57,416 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-22 18:29:57,438 | INFO | Filas leídas CLIENTES: 30
2026-01-22 18:29:57,447 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-22 18:29:57,448 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-22 18:29:57,451 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-22 18:29:57,452 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-22 18:29:57,466 | INFO | Filas leídas TARJETAS: 30
2026-01-22 18:29:57,474 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-22 18:29:57,477 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-22 18:29:57,479 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-22 18:29:57,485 | WARNING | Total filas erróneas registradas: 6
2026-01-22 18:29:57,485 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-22 18:29:57,486 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-22 18:29:57,622 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-22 18:29:57,653 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-22 18:29:57,653 | INFO | Carga a PostgreSQL completada
2026-01-22 18:29:57,653 | INFO | Fin del pipeline ETL
2026-01-25 17:08:15,073 | INFO | Inicio del pipeline ETL
2026-01-25 17:08:15,076 | INFO | Clientes encontrados: 1
2026-01-25 17:08:15,077 | INFO | Tarjetas encontradas: 1
2026-01-25 17:08:15,077 | INFO | Ficheros ignorados: 1
2026-01-25 17:08:15,077 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-25 17:08:15,139 | INFO | Filas leídas CLIENTES: 30
2026-01-25 17:08:15,188 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-25 17:08:15,193 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-25 17:08:15,199 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-25 17:08:15,200 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-25 17:08:15,236 | INFO | Filas leídas TARJETAS: 30
2026-01-25 17:08:15,257 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-25 17:08:15,260 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-25 17:08:15,266 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-25 17:08:15,287 | WARNING | Total filas erróneas registradas: 6
2026-01-25 17:08:15,287 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-25 17:08:15,289 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-25 17:08:15,823 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-25 17:08:15,855 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-25 17:08:15,855 | INFO | Carga a PostgreSQL completada
2026-01-25 17:08:15,856 | INFO | Fin del pipeline ETL
2026-01-25 17:58:55,747 | INFO | Inicio del pipeline ETL
2026-01-25 17:58:55,754 | INFO | Clientes encontrados: 1
2026-01-25 17:58:55,755 | INFO | Tarjetas encontradas: 1
2026-01-25 17:58:55,755 | INFO | Ficheros ignorados: 1
2026-01-25 17:58:55,755 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-25 17:58:55,776 | INFO | Filas leídas CLIENTES: 30
2026-01-25 17:58:55,814 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-25 17:58:55,818 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-25 17:58:55,825 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-25 17:58:55,828 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-25 17:58:55,834 | INFO | Filas leídas TARJETAS: 30
2026-01-25 17:58:55,863 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-25 17:58:55,865 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-25 17:58:55,869 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-25 17:58:55,891 | WARNING | Total filas erróneas registradas: 6
2026-01-25 17:58:55,893 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-25 17:58:55,897 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-25 17:58:56,194 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-25 17:58:56,226 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-25 17:58:56,227 | INFO | Carga a PostgreSQL completada
2026-01-25 17:58:56,227 | INFO | Fin del pipeline ETL
2026-01-25 18:30:50,736 | INFO | Inicio del pipeline ETL
2026-01-25 18:30:50,739 | INFO | Clientes encontrados: 1
2026-01-25 18:30:50,740 | INFO | Tarjetas encontradas: 1
2026-01-25 18:30:50,740 | INFO | Ficheros ignorados: 1
2026-01-25 18:30:50,741 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-25 18:30:50,749 | INFO | Filas leídas CLIENTES: 30
2026-01-25 18:30:50,786 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-25 18:30:50,789 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-25 18:30:50,844 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-25 18:30:50,902 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-25 18:30:50,929 | INFO | Filas leídas TARJETAS: 30
2026-01-25 18:30:50,951 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-25 18:30:50,956 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-25 18:30:50,961 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-25 18:30:51,001 | WARNING | Total filas erróneas registradas: 6
2026-01-25 18:30:51,001 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-25 18:30:51,004 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-25 18:30:51,175 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-25 18:30:51,186 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-25 18:30:51,188 | INFO | Carga a PostgreSQL completada
2026-01-25 18:30:51,189 | INFO | Fin del pipeline ETL
2026-01-25 19:05:23,558 | INFO | Inicio del pipeline ETL
2026-01-25 19:05:23,559 | INFO | Clientes encontrados: 1
2026-01-25 19:05:23,559 | INFO | Tarjetas encontradas: 1
2026-01-25 19:05:23,559 | INFO | Ficheros ignorados: 1
2026-01-25 19:05:23,559 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-25 19:05:23,563 | INFO | Filas leídas CLIENTES: 30
2026-01-25 19:05:23,569 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-25 19:05:23,569 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-25 19:05:23,571 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-25 19:05:23,571 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-25 19:05:23,572 | INFO | Filas leídas TARJETAS: 30
2026-01-25 19:05:23,573 | ERROR | Error procesando TARJETAS: Tarjetas-2025-11-10.csv
Traceback (most recent call last):
  File "c:\Users\sotos\Downloads\etl-proyecto\etl-proyecto\scripts\run_pipeline.py", line 111, in main
    df = clean_tarjetas(df)
  File "C:\Users\sotos\Downloads\etl-proyecto\etl-proyecto\etl\clean_tarjetas.py", line 36, in clean_tarjetas
    df["numero_tarjeta_masked"] = df["card_clean"].apply(mask_card)
                                  ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\series.py", line 5084, in apply
    ).apply()
      ~~~~~^^
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1520, in apply
    return self.apply_standard()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1578, in apply_standard
    mapped = obj._map_values(mapper=curried)
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\base.py", line 1020, in _map_values
    return arr.map(mapper, na_action=na_action)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\arrays\base.py", line 2692, in map
    return map_array(self, mapper, na_action=na_action)
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\algorithms.py", line 1710, in map_array
    return lib.map_infer(values, mapper)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 3071, in pandas._libs.lib.map_infer
  File "C:\Users\sotos\Downloads\etl-proyecto\etl-proyecto\etl\clean_tarjetas.py", line 17, in mask_card
    if not card_digits or len(card_digits) < 4:
                          ~~~^^^^^^^^^^^^^
TypeError: object of type 'float' has no len()
2026-01-25 19:05:23,578 | WARNING | Total filas erróneas registradas: 5
2026-01-25 19:05:23,578 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-25 19:05:23,579 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-25 19:05:23,728 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-25 19:05:23,730 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-25 19:05:23,730 | INFO | Carga a PostgreSQL completada
2026-01-25 19:05:23,731 | INFO | Fin del pipeline ETL
2026-01-25 19:10:39,154 | INFO | Inicio del pipeline ETL
2026-01-25 19:10:39,154 | INFO | Clientes encontrados: 1
2026-01-25 19:10:39,154 | INFO | Tarjetas encontradas: 1
2026-01-25 19:10:39,155 | INFO | Ficheros ignorados: 1
2026-01-25 19:10:39,155 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-25 19:10:39,158 | INFO | Filas leídas CLIENTES: 30
2026-01-25 19:10:39,163 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-25 19:10:39,164 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-25 19:10:39,165 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-25 19:10:39,165 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-25 19:10:39,167 | INFO | Filas leídas TARJETAS: 30
2026-01-25 19:10:39,170 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-25 19:10:39,170 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-25 19:10:39,171 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-25 19:10:39,174 | WARNING | Total filas erróneas registradas: 6
2026-01-25 19:10:39,175 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-25 19:10:39,175 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-25 19:10:39,213 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-25 19:10:39,222 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-25 19:10:39,223 | INFO | Carga a PostgreSQL completada
2026-01-25 19:10:39,223 | INFO | Fin del pipeline ETL
2026-01-25 19:12:31,151 | INFO | Inicio del pipeline ETL
2026-01-25 19:12:31,152 | INFO | Clientes encontrados: 1
2026-01-25 19:12:31,152 | INFO | Tarjetas encontradas: 1
2026-01-25 19:12:31,152 | INFO | Ficheros ignorados: 1
2026-01-25 19:12:31,152 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-25 19:12:31,156 | INFO | Filas leídas CLIENTES: 30
2026-01-25 19:12:31,161 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-25 19:12:31,162 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-25 19:12:31,164 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-25 19:12:31,164 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-25 19:12:31,165 | INFO | Filas leídas TARJETAS: 30
2026-01-25 19:12:31,166 | ERROR | Error procesando TARJETAS: Tarjetas-2025-11-10.csv
Traceback (most recent call last):
  File "c:\Users\sotos\Downloads\etl-proyecto\etl-proyecto\scripts\run_pipeline.py", line 111, in main
    df = clean_tarjetas(df)
  File "C:\Users\sotos\Downloads\etl-proyecto\etl-proyecto\etl\clean_tarjetas.py", line 36, in clean_tarjetas
    df["numero_tarjeta_masked"] = df["card_clean"].apply(mask_card)
                                  ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\series.py", line 5084, in apply
    ).apply()
      ~~~~~^^
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1520, in apply
    return self.apply_standard()
           ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\apply.py", line 1578, in apply_standard
    mapped = obj._map_values(mapper=curried)
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\base.py", line 1020, in _map_values
    return arr.map(mapper, na_action=na_action)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\arrays\base.py", line 2692, in map
    return map_array(self, mapper, na_action=na_action)
  File "C:\Users\sotos\AppData\Local\Programs\Python\Python313\Lib\site-packages\pandas\core\algorithms.py", line 1710, in map_array
    return lib.map_infer(values, mapper)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 3071, in pandas._libs.lib.map_infer
  File "C:\Users\sotos\Downloads\etl-proyecto\etl-proyecto\etl\clean_tarjetas.py", line 17, in mask_card
    if not card_digits or len(card_digits) < 4:
                          ~~~^^^^^^^^^^^^^
TypeError: object of type 'float' has no len()
2026-01-25 19:12:31,170 | WARNING | Total filas erróneas registradas: 5
2026-01-25 19:12:31,171 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-25 19:12:31,171 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-25 19:12:31,201 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-25 19:12:31,203 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-25 19:12:31,204 | INFO | Carga a PostgreSQL completada
2026-01-25 19:12:31,204 | INFO | Fin del pipeline ETL
2026-01-25 19:13:13,402 | INFO | Inicio del pipeline ETL
2026-01-25 19:13:13,403 | INFO | Clientes encontrados: 1
2026-01-25 19:13:13,403 | INFO | Tarjetas encontradas: 1
2026-01-25 19:13:13,403 | INFO | Ficheros ignorados: 1
2026-01-25 19:13:13,403 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-25 19:13:13,406 | INFO | Filas leídas CLIENTES: 30
2026-01-25 19:13:13,411 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-25 19:13:13,411 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-25 19:13:13,413 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-25 19:13:13,413 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-25 19:13:13,414 | INFO | Filas leídas TARJETAS: 30
2026-01-25 19:13:13,418 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-25 19:13:13,418 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-25 19:13:13,419 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-25 19:13:13,422 | WARNING | Total filas erróneas registradas: 6
2026-01-25 19:13:13,422 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-25 19:13:13,423 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-25 19:13:13,453 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-25 19:13:13,456 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-25 19:13:13,456 | INFO | Carga a PostgreSQL completada
2026-01-25 19:13:13,456 | INFO | Fin del pipeline ETL
2026-01-25 19:25:06,518 | INFO | Inicio del pipeline ETL
2026-01-25 19:25:06,519 | INFO | Clientes encontrados: 1
2026-01-25 19:25:06,519 | INFO | Tarjetas encontradas: 1
2026-01-25 19:25:06,519 | INFO | Ficheros ignorados: 1
2026-01-25 19:25:06,519 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-25 19:25:06,522 | INFO | Filas leídas CLIENTES: 30
2026-01-25 19:25:06,527 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-25 19:25:06,528 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-25 19:25:06,529 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-25 19:25:06,529 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-25 19:25:06,530 | INFO | Filas leídas TARJETAS: 30
2026-01-25 19:25:06,534 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-25 19:25:06,534 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-25 19:25:06,535 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-25 19:25:06,538 | WARNING | Total filas erróneas registradas: 6
2026-01-25 19:25:06,538 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-25 19:25:06,539 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-25 19:25:06,569 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-25 19:25:06,572 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-25 19:25:06,572 | INFO | Carga a PostgreSQL completada
2026-01-25 19:25:06,572 | INFO | Fin del pipeline ETL
2026-01-31 19:18:28,931 | INFO | Inicio del pipeline ETL
2026-01-31 19:18:28,932 | INFO | Clientes encontrados: 1
2026-01-31 19:18:28,932 | INFO | Tarjetas encontradas: 1
2026-01-31 19:18:28,932 | INFO | Ficheros ignorados: 1
2026-01-31 19:18:28,932 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 19:18:28,940 | INFO | Filas leídas CLIENTES: 30
2026-01-31 19:18:28,949 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-31 19:18:28,949 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-31 19:18:28,953 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 19:18:28,953 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 19:18:28,955 | INFO | Filas leídas TARJETAS: 30
2026-01-31 19:18:28,959 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-31 19:18:28,959 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 19:18:28,960 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 19:18:28,964 | WARNING | Total filas erróneas registradas: 6
2026-01-31 19:18:28,964 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 19:18:28,964 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-31 19:18:28,998 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 160, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 170, in load_cleaned_to_postgres
    conn = _get_conn()
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 48, in _get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=host,
        ^^^^^^^^^^
    ...<4 lines>...
        connect_timeout=5,
        ^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
2026-01-31 19:18:28,999 | INFO | Fin del pipeline ETL
2026-01-31 19:30:20,050 | INFO | Inicio del pipeline ETL
2026-01-31 19:30:20,051 | INFO | Clientes encontrados: 1
2026-01-31 19:30:20,051 | INFO | Tarjetas encontradas: 1
2026-01-31 19:30:20,051 | INFO | Ficheros ignorados: 1
2026-01-31 19:30:20,051 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 19:30:20,054 | INFO | Filas leídas CLIENTES: 30
2026-01-31 19:30:20,060 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-31 19:30:20,060 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-31 19:30:20,061 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 19:30:20,061 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 19:30:20,063 | INFO | Filas leídas TARJETAS: 30
2026-01-31 19:30:20,066 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-31 19:30:20,066 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 19:30:20,067 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 19:30:20,070 | WARNING | Total filas erróneas registradas: 6
2026-01-31 19:30:20,070 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 19:30:20,071 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-31 19:30:20,104 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 160, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 171, in load_cleaned_to_postgres
    conn = _get_conn()
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 48, in _get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=host,
        ^^^^^^^^^^
    ...<5 lines>...
        options="-c lc_messages=C -c client_encoding=UTF8",
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
2026-01-31 19:30:20,105 | INFO | Fin del pipeline ETL
2026-01-31 19:36:31,194 | INFO | Inicio del pipeline ETL
2026-01-31 19:36:31,194 | INFO | Clientes encontrados: 1
2026-01-31 19:36:31,194 | INFO | Tarjetas encontradas: 1
2026-01-31 19:36:31,194 | INFO | Ficheros ignorados: 1
2026-01-31 19:36:31,194 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 19:36:31,197 | INFO | Filas leídas CLIENTES: 30
2026-01-31 19:36:31,203 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-31 19:36:31,203 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-31 19:36:31,204 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 19:36:31,204 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 19:36:31,206 | INFO | Filas leídas TARJETAS: 30
2026-01-31 19:36:31,209 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-31 19:36:31,209 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 19:36:31,210 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 19:36:31,213 | WARNING | Total filas erróneas registradas: 6
2026-01-31 19:36:31,213 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 19:36:31,213 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-31 19:36:31,247 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 160, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 171, in load_cleaned_to_postgres
    conn = _get_conn()
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 48, in _get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=host,
        ^^^^^^^^^^
    ...<5 lines>...
        options="-c lc_messages=C -c client_encoding=UTF8",
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 85: invalid continuation byte
2026-01-31 19:36:31,248 | INFO | Fin del pipeline ETL
2026-01-31 19:39:26,234 | INFO | Inicio del pipeline ETL
2026-01-31 19:39:26,234 | INFO | Clientes encontrados: 1
2026-01-31 19:39:26,234 | INFO | Tarjetas encontradas: 1
2026-01-31 19:39:26,234 | INFO | Ficheros ignorados: 1
2026-01-31 19:39:26,234 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 19:39:26,237 | INFO | Filas leídas CLIENTES: 30
2026-01-31 19:39:26,243 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-31 19:39:26,243 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-31 19:39:26,244 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 19:39:26,244 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 19:39:26,246 | INFO | Filas leídas TARJETAS: 30
2026-01-31 19:39:26,249 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-31 19:39:26,249 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 19:39:26,250 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 19:39:26,253 | WARNING | Total filas erróneas registradas: 6
2026-01-31 19:39:26,253 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 19:39:26,253 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-31 19:39:26,287 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 160, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 171, in load_cleaned_to_postgres
    conn = _get_conn()
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 48, in _get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=host,
        ^^^^^^^^^^
    ...<5 lines>...
        options="-c lc_messages=C -c client_encoding=UTF8",
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 76: invalid start byte
2026-01-31 19:39:26,288 | INFO | Fin del pipeline ETL
2026-01-31 19:46:54,763 | INFO | Inicio del pipeline ETL
2026-01-31 19:46:54,764 | INFO | Clientes encontrados: 1
2026-01-31 19:46:54,764 | INFO | Tarjetas encontradas: 1
2026-01-31 19:46:54,764 | INFO | Ficheros ignorados: 1
2026-01-31 19:46:54,764 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 19:46:54,767 | INFO | Filas leídas CLIENTES: 30
2026-01-31 19:46:54,773 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-31 19:46:54,774 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-31 19:46:54,775 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 19:46:54,775 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 19:46:54,776 | INFO | Filas leídas TARJETAS: 30
2026-01-31 19:46:54,780 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-31 19:46:54,780 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 19:46:54,781 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 19:46:54,784 | WARNING | Total filas erróneas registradas: 6
2026-01-31 19:46:54,784 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 19:46:54,785 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-31 19:46:54,821 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 160, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 171, in load_cleaned_to_postgres
    conn = _get_conn()
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 48, in _get_conn
    return psycopg2.connect(
           ~~~~~~~~~~~~~~~~^
        host=host,
        ^^^^^^^^^^
    ...<5 lines>...
        options="-c lc_messages=C -c client_encoding=UTF8",
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\psycopg2\__init__.py", line 135, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  se ha denegado el permiso para cambiar la opción «lc_messages»

2026-01-31 19:46:54,822 | INFO | Fin del pipeline ETL
2026-01-31 19:47:51,764 | INFO | Inicio del pipeline ETL
2026-01-31 19:47:51,765 | INFO | Clientes encontrados: 1
2026-01-31 19:47:51,765 | INFO | Tarjetas encontradas: 1
2026-01-31 19:47:51,765 | INFO | Ficheros ignorados: 1
2026-01-31 19:47:51,765 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 19:47:51,769 | INFO | Filas leídas CLIENTES: 30
2026-01-31 19:47:51,775 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-31 19:47:51,775 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-31 19:47:51,776 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 19:47:51,776 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 19:47:51,778 | INFO | Filas leídas TARJETAS: 30
2026-01-31 19:47:51,781 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-31 19:47:51,781 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 19:47:51,782 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 19:47:51,786 | WARNING | Total filas erróneas registradas: 6
2026-01-31 19:47:51,786 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 19:47:51,786 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-31 19:47:51,831 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 160, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 176, in load_cleaned_to_postgres
    _load_clientes_csv(conn, f, logger=logger)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 127, in _load_clientes_csv
    execute_values(cur, sql, rows, page_size=1000)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedTable: no existe la relación «clientes»
LINE 2:     INSERT INTO clientes (
                        ^

2026-01-31 19:47:51,832 | INFO | Fin del pipeline ETL
2026-01-31 19:51:39,106 | INFO | Inicio del pipeline ETL
2026-01-31 19:51:39,107 | INFO | Clientes encontrados: 1
2026-01-31 19:51:39,107 | INFO | Tarjetas encontradas: 1
2026-01-31 19:51:39,107 | INFO | Ficheros ignorados: 1
2026-01-31 19:51:39,107 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 19:51:39,110 | INFO | Filas leídas CLIENTES: 30
2026-01-31 19:51:39,117 | WARNING | Filas rechazadas CLIENTES: 5
2026-01-31 19:51:39,118 | WARNING | CLIENTES motivo='dni_invalido|telefono_invalido|correo_invalido' -> 5
2026-01-31 19:51:39,119 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 19:51:39,119 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 19:51:39,120 | INFO | Filas leídas TARJETAS: 30
2026-01-31 19:51:39,124 | WARNING | Filas rechazadas TARJETAS: 1
2026-01-31 19:51:39,124 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 19:51:39,125 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 19:51:39,128 | WARNING | Total filas erróneas registradas: 6
2026-01-31 19:51:39,129 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 19:51:39,129 | INFO | BD: found cleaned clientes=1 tarjetas=1
2026-01-31 19:51:39,163 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 19:51:39,178 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 19:51:39,184 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 19:51:39,188 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-31 19:51:39,188 | INFO | Carga a PostgreSQL completada
2026-01-31 19:51:39,188 | INFO | Fin del pipeline ETL
2026-01-31 20:28:43,560 | INFO | Inicio del pipeline ETL
2026-01-31 20:28:43,561 | INFO | Clientes encontrados: 2
2026-01-31 20:28:43,561 | INFO | Tarjetas encontradas: 2
2026-01-31 20:28:43,561 | INFO | Ficheros ignorados: 1
2026-01-31 20:28:43,561 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 20:28:43,569 | INFO | Filas leídas CLIENTES: 25
2026-01-31 20:28:43,575 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 20:28:43,576 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 20:28:43,576 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 20:28:43,579 | INFO | Filas leídas CLIENTES: 50
2026-01-31 20:28:43,584 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 20:28:43,585 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 20:28:43,585 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 20:28:43,586 | INFO | Filas leídas TARJETAS: 29
2026-01-31 20:28:43,589 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 20:28:43,590 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 20:28:43,590 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 20:28:43,591 | INFO | Filas leídas TARJETAS: 60
2026-01-31 20:28:43,594 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 20:28:43,595 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 20:28:43,595 | INFO | No hay filas erróneas. No se generan CSV de rechazadas
2026-01-31 20:28:43,595 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 20:28:43,595 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 20:28:43,635 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 20:28:43,645 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 20:28:43,651 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 20:28:43,655 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 20:28:43,658 | INFO | BD: tarjetas cargadas desde Tarjetas-2025-11-10.cleaned.csv -> 29 filas
2026-01-31 20:28:43,662 | INFO | BD: tarjetas cargadas desde Tarjetas-2026-01-19.cleaned.csv -> 60 filas
2026-01-31 20:28:43,662 | INFO | Carga a PostgreSQL completada
2026-01-31 20:28:43,662 | INFO | Fin del pipeline ETL
2026-01-31 20:52:47,404 | INFO | Inicio del pipeline ETL
2026-01-31 20:52:47,405 | INFO | Clientes encontrados: 2
2026-01-31 20:52:47,405 | INFO | Tarjetas encontradas: 2
2026-01-31 20:52:47,405 | INFO | Ficheros ignorados: 1
2026-01-31 20:52:47,405 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 20:52:47,413 | INFO | Filas leídas CLIENTES: 25
2026-01-31 20:52:47,419 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 20:52:47,420 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 20:52:47,420 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 20:52:47,423 | INFO | Filas leídas CLIENTES: 50
2026-01-31 20:52:47,428 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 20:52:47,429 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 20:52:47,429 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 20:52:47,431 | INFO | Filas leídas TARJETAS: 29
2026-01-31 20:52:47,434 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 20:52:47,435 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 20:52:47,435 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 20:52:47,437 | INFO | Filas leídas TARJETAS: 60
2026-01-31 20:52:47,440 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 20:52:47,441 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 20:52:47,441 | INFO | No hay filas erróneas. No se generan CSV de rechazadas
2026-01-31 20:52:47,441 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 20:52:47,441 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 20:52:47,475 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 20:52:47,483 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 20:52:47,488 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 20:52:47,492 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 20:52:47,492 | INFO | BD: TARJETAS TOTAL -> TRUNCATE public.tarjetas y cargar SOLO Tarjetas-2026-01-19.cleaned.csv
2026-01-31 20:52:47,499 | INFO | BD: tarjetas cargadas desde Tarjetas-2026-01-19.cleaned.csv -> 60 filas
2026-01-31 20:52:47,499 | INFO | Carga a PostgreSQL completada
2026-01-31 20:52:47,499 | INFO | Fin del pipeline ETL
2026-01-31 21:09:52,352 | INFO | Inicio del pipeline ETL
2026-01-31 21:09:52,353 | INFO | Clientes encontrados: 2
2026-01-31 21:09:52,353 | INFO | Tarjetas encontradas: 2
2026-01-31 21:09:52,353 | INFO | Ficheros ignorados: 1
2026-01-31 21:09:52,353 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 21:09:52,357 | INFO | Filas leídas CLIENTES: 25
2026-01-31 21:09:52,363 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:09:52,365 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 21:09:52,365 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 21:09:52,368 | INFO | Filas leídas CLIENTES: 50
2026-01-31 21:09:52,373 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:09:52,374 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 21:09:52,374 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 21:09:52,375 | INFO | Filas leídas TARJETAS: 29
2026-01-31 21:09:52,378 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:09:52,379 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 21:09:52,379 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 21:09:52,380 | INFO | Filas leídas TARJETAS: 60
2026-01-31 21:09:52,383 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:09:52,384 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 21:09:52,384 | INFO | No hay filas erróneas. No se generan CSV de rechazadas
2026-01-31 21:09:52,384 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 21:09:52,384 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 21:09:52,419 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 21:09:52,427 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 21:09:52,432 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 21:09:52,436 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 21:09:52,441 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-01-31 21:09:52,446 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-01-31 21:09:52,446 | INFO | Carga a PostgreSQL completada
2026-01-31 21:09:52,446 | INFO | Fin del pipeline ETL
2026-01-31 21:18:02,435 | INFO | Inicio del pipeline ETL
2026-01-31 21:18:02,436 | INFO | Clientes encontrados: 2
2026-01-31 21:18:02,436 | INFO | Tarjetas encontradas: 2
2026-01-31 21:18:02,436 | INFO | Ficheros ignorados: 1
2026-01-31 21:18:02,436 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 21:18:02,440 | INFO | Filas leídas CLIENTES: 30
2026-01-31 21:18:02,447 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 21:18:02,448 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 21:18:02,448 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 21:18:02,448 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 21:18:02,449 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 21:18:02,450 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 21:18:02,452 | INFO | Filas leídas CLIENTES: 50
2026-01-31 21:18:02,457 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:18:02,457 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 21:18:02,457 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 21:18:02,459 | INFO | Filas leídas TARJETAS: 35
2026-01-31 21:18:02,462 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 21:18:02,462 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 21:18:02,462 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 21:18:02,462 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 21:18:02,464 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 21:18:02,464 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 21:18:02,465 | INFO | Filas leídas TARJETAS: 60
2026-01-31 21:18:02,468 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:18:02,468 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 21:18:02,472 | WARNING | Total filas erróneas registradas: 8
2026-01-31 21:18:02,472 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 21:18:02,473 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 21:18:02,509 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 21:18:02,517 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 21:18:02,522 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 26 filas
2026-01-31 21:18:02,526 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 21:18:02,530 | INFO | BD: tarjetas merged -> 52 filas tras deduplicar por cod_cliente
2026-01-31 21:18:02,536 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 160, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 284, in load_cleaned_to_postgres
    _insert_tarjetas_df(conn, df_merged, logger=logger, source="merged tarjetas (max fecha_exp)")
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 229, in _insert_tarjetas_df
    execute_values(cur, sql, rows, page_size=1000)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.ForeignKeyViolation: inserción o actualización en la tabla «tarjetas» viola la llave foránea «fk_tarjetas_cliente»
DETAIL:  La llave (cod_cliente)=(C900) no está presente en la tabla «clientes».

2026-01-31 21:18:02,538 | INFO | Fin del pipeline ETL
2026-01-31 21:19:09,955 | INFO | Inicio del pipeline ETL
2026-01-31 21:19:09,955 | INFO | Clientes encontrados: 2
2026-01-31 21:19:09,955 | INFO | Tarjetas encontradas: 2
2026-01-31 21:19:09,955 | INFO | Ficheros ignorados: 1
2026-01-31 21:19:09,955 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 21:19:09,959 | INFO | Filas leídas CLIENTES: 30
2026-01-31 21:19:09,965 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 21:19:09,966 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 21:19:09,966 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 21:19:09,966 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 21:19:09,967 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 21:19:09,967 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 21:19:09,970 | INFO | Filas leídas CLIENTES: 50
2026-01-31 21:19:09,974 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:19:09,975 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 21:19:09,975 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 21:19:09,976 | INFO | Filas leídas TARJETAS: 35
2026-01-31 21:19:09,980 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 21:19:09,980 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 21:19:09,980 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 21:19:09,980 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 21:19:09,981 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 21:19:09,981 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 21:19:09,983 | INFO | Filas leídas TARJETAS: 60
2026-01-31 21:19:09,986 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:19:09,987 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 21:19:09,990 | WARNING | Total filas erróneas registradas: 8
2026-01-31 21:19:09,990 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 21:19:09,991 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 21:19:10,025 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 21:19:10,031 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 21:19:10,036 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 26 filas
2026-01-31 21:19:10,041 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 21:19:10,045 | INFO | BD: tarjetas merged -> 52 filas tras deduplicar por cod_cliente
2026-01-31 21:19:10,050 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 160, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 284, in load_cleaned_to_postgres
    _insert_tarjetas_df(conn, df_merged, logger=logger, source="merged tarjetas (max fecha_exp)")
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 229, in _insert_tarjetas_df
    execute_values(cur, sql, rows, page_size=1000)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.ForeignKeyViolation: inserción o actualización en la tabla «tarjetas» viola la llave foránea «fk_tarjetas_cliente»
DETAIL:  La llave (cod_cliente)=(C900) no está presente en la tabla «clientes».

2026-01-31 21:19:10,051 | INFO | Fin del pipeline ETL
2026-01-31 21:32:31,670 | INFO | Inicio del pipeline ETL
2026-01-31 21:32:31,670 | INFO | Clientes encontrados: 2
2026-01-31 21:32:31,671 | INFO | Tarjetas encontradas: 2
2026-01-31 21:32:31,671 | INFO | Ficheros ignorados: 1
2026-01-31 21:32:31,671 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 21:32:31,674 | INFO | Filas leídas CLIENTES: 29
2026-01-31 21:32:31,682 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 21:32:31,682 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 21:32:31,682 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 21:32:31,682 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 21:32:31,684 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 21:32:31,684 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 21:32:31,687 | INFO | Filas leídas CLIENTES: 50
2026-01-31 21:32:31,693 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:32:31,693 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 21:32:31,693 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 21:32:31,695 | INFO | Filas leídas TARJETAS: 33
2026-01-31 21:32:31,699 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 21:32:31,699 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 21:32:31,699 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 21:32:31,699 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 21:32:31,700 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 21:32:31,700 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 21:32:31,701 | INFO | Filas leídas TARJETAS: 60
2026-01-31 21:32:31,704 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:32:31,705 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 21:32:31,712 | WARNING | Total filas erróneas registradas: 8
2026-01-31 21:32:31,712 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 21:32:31,712 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 21:32:31,755 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 21:32:31,756 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 21:32:31,763 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 21:32:31,768 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 21:32:31,772 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-01-31 21:32:31,779 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-01-31 21:32:31,779 | INFO | Carga a PostgreSQL completada
2026-01-31 21:32:31,779 | INFO | Fin del pipeline ETL
2026-01-31 21:39:03,567 | INFO | Inicio del pipeline ETL
2026-01-31 21:39:03,567 | INFO | Clientes encontrados: 2
2026-01-31 21:39:03,567 | INFO | Tarjetas encontradas: 2
2026-01-31 21:39:03,567 | INFO | Ficheros ignorados: 1
2026-01-31 21:39:03,567 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 21:39:03,575 | INFO | Filas leídas CLIENTES: 29
2026-01-31 21:39:03,581 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 21:39:03,582 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 21:39:03,582 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 21:39:03,582 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 21:39:03,585 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 21:39:03,585 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 21:39:03,588 | INFO | Filas leídas CLIENTES: 50
2026-01-31 21:39:03,593 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:39:03,594 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 21:39:03,594 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 21:39:03,596 | INFO | Filas leídas TARJETAS: 33
2026-01-31 21:39:03,599 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 21:39:03,600 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 21:39:03,600 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 21:39:03,600 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 21:39:03,601 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 21:39:03,601 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 21:39:03,602 | INFO | Filas leídas TARJETAS: 60
2026-01-31 21:39:03,605 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:39:03,606 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 21:39:03,610 | INFO | CLIENTES: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:39:03,610 | INFO | TARJETAS: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:39:03,610 | WARNING | Total filas erróneas registradas: 8
2026-01-31 21:39:03,610 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 21:39:03,611 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 21:39:03,645 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 21:39:03,646 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 21:39:03,654 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 21:39:03,658 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 21:39:03,662 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-01-31 21:39:03,668 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-01-31 21:39:03,668 | INFO | Carga a PostgreSQL completada
2026-01-31 21:39:03,668 | INFO | Fin del pipeline ETL
2026-01-31 21:42:43,408 | INFO | Inicio del pipeline ETL
2026-01-31 21:42:43,410 | INFO | Clientes encontrados: 2
2026-01-31 21:42:43,410 | INFO | Tarjetas encontradas: 2
2026-01-31 21:42:43,410 | INFO | Ficheros ignorados: 1
2026-01-31 21:42:43,410 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 21:42:43,420 | INFO | Filas leídas CLIENTES: 29
2026-01-31 21:42:43,434 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 21:42:43,434 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 21:42:43,434 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 21:42:43,435 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 21:42:43,436 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 21:42:43,436 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 21:42:43,440 | INFO | Filas leídas CLIENTES: 50
2026-01-31 21:42:43,445 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:42:43,446 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 21:42:43,446 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 21:42:43,448 | INFO | Filas leídas TARJETAS: 33
2026-01-31 21:42:43,453 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 21:42:43,453 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 21:42:43,453 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 21:42:43,453 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 21:42:43,454 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 21:42:43,454 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 21:42:43,455 | INFO | Filas leídas TARJETAS: 60
2026-01-31 21:42:43,459 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:42:43,460 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 21:42:43,464 | INFO | CLIENTES: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:42:43,465 | INFO | TARJETAS: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:42:43,465 | WARNING | Total filas erróneas registradas: 8
2026-01-31 21:42:43,465 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 21:42:43,465 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 21:42:43,505 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 21:42:43,507 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 21:42:43,513 | ERROR | Fallo en la carga a PostgreSQL
Traceback (most recent call last):
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\scripts\run_pipeline.py", line 165, in main
    db_loader.load_cleaned_to_postgres(OUTPUT_PATH, logger=logger)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 270, in load_cleaned_to_postgres
    _load_clientes_csv(conn, f, logger=logger)
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\IdeaProjects\etl-proyecto\etl\db_loader.py", line 163, in _load_clientes_csv
    execute_values(cur, sql, rows, page_size=1000)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jorge\AppData\Local\Programs\Python\Python314\Lib\site-packages\psycopg2\extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
psycopg2.errors.NotNullViolation: el valor nulo en la columna «cod_cliente» de la relación «clientes» viola la restricción “not-null”
DETAIL:  La fila que falla contiene (null, null, null, null, null, null, null, null, null, null, null, null, null).

2026-01-31 21:42:43,521 | INFO | Fin del pipeline ETL
2026-01-31 21:48:19,384 | INFO | Inicio del pipeline ETL
2026-01-31 21:48:19,384 | INFO | Clientes encontrados: 2
2026-01-31 21:48:19,385 | INFO | Tarjetas encontradas: 2
2026-01-31 21:48:19,385 | INFO | Ficheros ignorados: 1
2026-01-31 21:48:19,385 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 21:48:19,389 | INFO | Filas leídas CLIENTES: 29
2026-01-31 21:48:19,396 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 21:48:19,396 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 21:48:19,396 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 21:48:19,396 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 21:48:19,399 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 21:48:19,399 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 21:48:19,402 | INFO | Filas leídas CLIENTES: 50
2026-01-31 21:48:19,410 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:48:19,411 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 21:48:19,411 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 21:48:19,412 | INFO | Filas leídas TARJETAS: 33
2026-01-31 21:48:19,416 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 21:48:19,417 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 21:48:19,417 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 21:48:19,417 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 21:48:19,418 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 21:48:19,418 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 21:48:19,420 | INFO | Filas leídas TARJETAS: 60
2026-01-31 21:48:19,423 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:48:19,424 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 21:48:19,429 | INFO | CLIENTES: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:48:19,429 | INFO | TARJETAS: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:48:19,429 | WARNING | Total filas erróneas registradas: 8
2026-01-31 21:48:19,429 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 21:48:19,430 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 21:48:19,470 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 21:48:19,472 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 21:48:19,477 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 21:48:19,481 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 21:48:19,486 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-01-31 21:48:19,493 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-01-31 21:48:19,493 | INFO | Carga a PostgreSQL completada
2026-01-31 21:48:19,493 | INFO | Fin del pipeline ETL
2026-01-31 21:49:50,815 | INFO | Inicio del pipeline ETL
2026-01-31 21:49:50,816 | INFO | Clientes encontrados: 2
2026-01-31 21:49:50,816 | INFO | Tarjetas encontradas: 2
2026-01-31 21:49:50,816 | INFO | Ficheros ignorados: 1
2026-01-31 21:49:50,816 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 21:49:50,820 | INFO | Filas leídas CLIENTES: 29
2026-01-31 21:49:50,826 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 21:49:50,826 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 21:49:50,826 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 21:49:50,826 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 21:49:50,827 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 21:49:50,827 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 21:49:50,830 | INFO | Filas leídas CLIENTES: 50
2026-01-31 21:49:50,835 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:49:50,835 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 21:49:50,835 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 21:49:50,837 | INFO | Filas leídas TARJETAS: 33
2026-01-31 21:49:50,840 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 21:49:50,840 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 21:49:50,840 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 21:49:50,840 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 21:49:50,841 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 21:49:50,841 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 21:49:50,842 | INFO | Filas leídas TARJETAS: 60
2026-01-31 21:49:50,845 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:49:50,846 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 21:49:50,850 | INFO | CLIENTES: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:49:50,850 | INFO | TARJETAS: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:49:50,850 | WARNING | Total filas erróneas registradas: 8
2026-01-31 21:49:50,850 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 21:49:50,851 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 21:49:50,885 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 21:49:50,893 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 21:49:50,898 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 21:49:50,902 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 21:49:50,906 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-01-31 21:49:50,910 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-01-31 21:49:50,911 | INFO | Carga a PostgreSQL completada
2026-01-31 21:49:50,911 | INFO | Fin del pipeline ETL
2026-01-31 21:50:42,567 | INFO | Inicio del pipeline ETL
2026-01-31 21:50:42,568 | INFO | Clientes encontrados: 2
2026-01-31 21:50:42,568 | INFO | Tarjetas encontradas: 2
2026-01-31 21:50:42,568 | INFO | Ficheros ignorados: 1
2026-01-31 21:50:42,568 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 21:50:42,572 | INFO | Filas leídas CLIENTES: 29
2026-01-31 21:50:42,579 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 21:50:42,579 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 21:50:42,579 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 21:50:42,579 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 21:50:42,581 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 21:50:42,581 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 21:50:42,583 | INFO | Filas leídas CLIENTES: 50
2026-01-31 21:50:42,588 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 21:50:42,589 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 21:50:42,589 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 21:50:42,590 | INFO | Filas leídas TARJETAS: 33
2026-01-31 21:50:42,593 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 21:50:42,593 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 21:50:42,594 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 21:50:42,594 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 21:50:42,594 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 21:50:42,594 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 21:50:42,596 | INFO | Filas leídas TARJETAS: 60
2026-01-31 21:50:42,599 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 21:50:42,599 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 21:50:42,603 | INFO | CLIENTES: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:50:42,603 | INFO | TARJETAS: no hay filas rechazadas. No se genera CSV.
2026-01-31 21:50:42,604 | WARNING | Total filas erróneas registradas: 8
2026-01-31 21:50:42,604 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 21:50:42,604 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 21:50:42,643 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 21:50:42,644 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 21:50:42,651 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 21:50:42,655 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 21:50:42,659 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-01-31 21:50:42,664 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-01-31 21:50:42,665 | INFO | Carga a PostgreSQL completada
2026-01-31 21:50:42,665 | INFO | Fin del pipeline ETL
2026-01-31 22:00:03,130 | INFO | Inicio del pipeline ETL
2026-01-31 22:00:03,131 | INFO | Clientes encontrados: 2
2026-01-31 22:00:03,131 | INFO | Tarjetas encontradas: 2
2026-01-31 22:00:03,131 | INFO | Ficheros ignorados: 1
2026-01-31 22:00:03,131 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 22:00:03,135 | INFO | Filas leídas CLIENTES: 29
2026-01-31 22:00:03,142 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 22:00:03,142 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 22:00:03,142 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 22:00:03,142 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 22:00:03,144 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 22:00:03,144 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 22:00:03,147 | INFO | Filas leídas CLIENTES: 50
2026-01-31 22:00:03,152 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 22:00:03,153 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 22:00:03,153 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 22:00:03,155 | INFO | Filas leídas TARJETAS: 33
2026-01-31 22:00:03,159 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 22:00:03,159 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 22:00:03,159 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 22:00:03,159 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 22:00:03,161 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 22:00:03,161 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 22:00:03,162 | INFO | Filas leídas TARJETAS: 60
2026-01-31 22:00:03,165 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 22:00:03,165 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 22:00:03,169 | INFO | CLIENTES: no hay filas rechazadas. No se genera CSV.
2026-01-31 22:00:03,169 | INFO | TARJETAS: no hay filas rechazadas. No se genera CSV.
2026-01-31 22:00:03,169 | WARNING | Total filas erróneas registradas: 8
2026-01-31 22:00:03,170 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 22:00:03,170 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 22:00:03,204 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 22:00:03,206 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 22:00:03,211 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 22:00:03,215 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 22:00:03,220 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-01-31 22:00:03,226 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-01-31 22:00:03,226 | INFO | Carga a PostgreSQL completada
2026-01-31 22:00:03,226 | INFO | Fin del pipeline ETL
2026-01-31 22:02:36,860 | INFO | Inicio del pipeline ETL
2026-01-31 22:02:36,861 | INFO | Clientes encontrados: 2
2026-01-31 22:02:36,861 | INFO | Tarjetas encontradas: 2
2026-01-31 22:02:36,861 | INFO | Ficheros ignorados: 1
2026-01-31 22:02:36,861 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 22:02:36,864 | INFO | Filas leídas CLIENTES: 29
2026-01-31 22:02:36,870 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 22:02:36,871 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 22:02:36,871 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 22:02:36,871 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 22:02:36,872 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 22:02:36,872 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 22:02:36,876 | INFO | Filas leídas CLIENTES: 50
2026-01-31 22:02:36,881 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 22:02:36,882 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 22:02:36,882 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 22:02:36,883 | INFO | Filas leídas TARJETAS: 33
2026-01-31 22:02:36,887 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 22:02:36,887 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 22:02:36,887 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 22:02:36,887 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 22:02:36,888 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 22:02:36,888 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 22:02:36,889 | INFO | Filas leídas TARJETAS: 60
2026-01-31 22:02:36,892 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 22:02:36,893 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 22:02:36,898 | WARNING | Generado C:\Users\jorge\IdeaProjects\etl-proyecto\errors\Clientes.rows_rejected.csv -> 4 filas rechazadas (CLIENTES)
2026-01-31 22:02:36,898 | WARNING | Generado C:\Users\jorge\IdeaProjects\etl-proyecto\errors\Tarjetas.rows_rejected.csv -> 4 filas rechazadas (TARJETAS)
2026-01-31 22:02:36,898 | WARNING | Total filas erróneas registradas: 8
2026-01-31 22:02:36,898 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 22:02:36,899 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 22:02:36,933 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 22:02:36,934 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 22:02:36,939 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 22:02:36,943 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 22:02:36,947 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-01-31 22:02:36,952 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-01-31 22:02:36,953 | INFO | Carga a PostgreSQL completada
2026-01-31 22:02:36,953 | INFO | Fin del pipeline ETL
2026-01-31 22:05:49,689 | INFO | Inicio del pipeline ETL
2026-01-31 22:05:49,689 | INFO | Clientes encontrados: 2
2026-01-31 22:05:49,689 | INFO | Tarjetas encontradas: 2
2026-01-31 22:05:49,689 | INFO | Ficheros ignorados: 1
2026-01-31 22:05:49,690 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-01-31 22:05:49,693 | INFO | Filas leídas CLIENTES: 29
2026-01-31 22:05:49,700 | WARNING | Filas rechazadas CLIENTES: 4
2026-01-31 22:05:49,700 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-01-31 22:05:49,700 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-01-31 22:05:49,700 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-01-31 22:05:49,701 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-01-31 22:05:49,701 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-01-31 22:05:49,704 | INFO | Filas leídas CLIENTES: 50
2026-01-31 22:05:49,709 | INFO | Filas rechazadas CLIENTES: 0
2026-01-31 22:05:49,710 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-01-31 22:05:49,710 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-01-31 22:05:49,711 | INFO | Filas leídas TARJETAS: 33
2026-01-31 22:05:49,718 | WARNING | Filas rechazadas TARJETAS: 4
2026-01-31 22:05:49,718 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-01-31 22:05:49,718 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-01-31 22:05:49,718 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-01-31 22:05:49,719 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-01-31 22:05:49,719 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-01-31 22:05:49,721 | INFO | Filas leídas TARJETAS: 60
2026-01-31 22:05:49,724 | INFO | Filas rechazadas TARJETAS: 0
2026-01-31 22:05:49,725 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-01-31 22:05:49,729 | WARNING | Generado C:\Users\jorge\IdeaProjects\etl-proyecto\errors\Clientes.rows_rejected.csv -> 4 filas rechazadas (CLIENTES)
2026-01-31 22:05:49,729 | WARNING | Generado C:\Users\jorge\IdeaProjects\etl-proyecto\errors\Tarjetas.rows_rejected.csv -> 4 filas rechazadas (TARJETAS)
2026-01-31 22:05:49,729 | WARNING | Total filas erróneas registradas: 8
2026-01-31 22:05:49,729 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-01-31 22:05:49,730 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-01-31 22:05:49,770 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-01-31 22:05:49,772 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-01-31 22:05:49,777 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-01-31 22:05:49,781 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-01-31 22:05:49,786 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-01-31 22:05:49,793 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-01-31 22:05:49,793 | INFO | Carga a PostgreSQL completada
2026-01-31 22:05:49,793 | INFO | Fin del pipeline ETL
2026-02-01 17:12:38,105 | INFO | Inicio del pipeline ETL
2026-02-01 17:12:38,105 | INFO | Clientes encontrados: 2
2026-02-01 17:12:38,106 | INFO | Tarjetas encontradas: 2
2026-02-01 17:12:38,106 | INFO | Ficheros ignorados: 1
2026-02-01 17:12:38,106 | INFO | Procesando CLIENTES: Clientes-2025-11-10.csv
2026-02-01 17:12:38,117 | INFO | Filas leídas CLIENTES: 29
2026-02-01 17:12:38,126 | WARNING | Filas rechazadas CLIENTES: 4
2026-02-01 17:12:38,127 | WARNING | CLIENTES motivo='correo_invalido' -> 2
2026-02-01 17:12:38,127 | WARNING | CLIENTES motivo='dni_invalido' -> 1
2026-02-01 17:12:38,127 | WARNING | CLIENTES motivo='telefono_invalido' -> 1
2026-02-01 17:12:38,133 | INFO | Archivo generado: Clientes-2025-11-10.cleaned.csv
2026-02-01 17:12:38,133 | INFO | Procesando CLIENTES: Clientes-2026-01-19.csv
2026-02-01 17:12:38,136 | INFO | Filas leídas CLIENTES: 50
2026-02-01 17:12:38,143 | INFO | Filas rechazadas CLIENTES: 0
2026-02-01 17:12:38,144 | INFO | Archivo generado: Clientes-2026-01-19.cleaned.csv
2026-02-01 17:12:38,144 | INFO | Procesando TARJETAS: Tarjetas-2025-11-10.csv
2026-02-01 17:12:38,146 | INFO | Filas leídas TARJETAS: 33
2026-02-01 17:12:38,149 | WARNING | Filas rechazadas TARJETAS: 4
2026-02-01 17:12:38,149 | WARNING | TARJETAS motivo='fecha_exp_invalida' -> 2
2026-02-01 17:12:38,149 | WARNING | TARJETAS motivo='cod_cliente_invalido|fecha_exp_invalida|tarjeta_invalida' -> 1
2026-02-01 17:12:38,149 | WARNING | TARJETAS motivo='cod_cliente_invalido' -> 1
2026-02-01 17:12:38,150 | INFO | Archivo generado: Tarjetas-2025-11-10.cleaned.csv
2026-02-01 17:12:38,150 | INFO | Procesando TARJETAS: Tarjetas-2026-01-19.csv
2026-02-01 17:12:38,152 | INFO | Filas leídas TARJETAS: 60
2026-02-01 17:12:38,155 | INFO | Filas rechazadas TARJETAS: 0
2026-02-01 17:12:38,156 | INFO | Archivo generado: Tarjetas-2026-01-19.cleaned.csv
2026-02-01 17:12:38,160 | WARNING | Generado C:\Users\jorge\IdeaProjects\etl-proyecto\errors\Clientes.rows_rejected.csv -> 4 filas rechazadas (CLIENTES)
2026-02-01 17:12:38,161 | WARNING | Generado C:\Users\jorge\IdeaProjects\etl-proyecto\errors\Tarjetas.rows_rejected.csv -> 4 filas rechazadas (TARJETAS)
2026-02-01 17:12:38,161 | WARNING | Total filas erróneas registradas: 8
2026-02-01 17:12:38,161 | INFO | Iniciando carga de cleaned a PostgreSQL...
2026-02-01 17:12:38,161 | INFO | BD: found cleaned clientes=2 tarjetas=2
2026-02-01 17:12:38,235 | INFO | BD: conectado como user='etl_user' db='etlproyect' schema='public'
2026-02-01 17:12:38,240 | INFO | BD: tablas verificadas/creadas (public.clientes, public.tarjetas)
2026-02-01 17:12:38,260 | INFO | BD: clientes cargados desde Clientes-2025-11-10.cleaned.csv -> 25 filas
2026-02-01 17:12:38,266 | INFO | BD: clientes cargados desde Clientes-2026-01-19.cleaned.csv -> 50 filas
2026-02-01 17:12:38,272 | INFO | BD: tarjetas merged -> 50 filas tras deduplicar por cod_cliente
2026-02-01 17:12:38,287 | INFO | BD: tarjetas cargadas desde merged tarjetas (max fecha_exp) -> 50 filas
2026-02-01 17:12:38,287 | INFO | Carga a PostgreSQL completada
2026-02-01 17:12:38,287 | INFO | Fin del pipeline ETL
